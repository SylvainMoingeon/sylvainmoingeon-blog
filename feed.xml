<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/">
    <title>Sylvain Moingeon</title>
    <link href="https://www.sylvainmoingeon.fr/feed.xml" rel="self" />
    <link href="https://www.sylvainmoingeon.fr" />
    <updated>2024-08-26T17:07:23+02:00</updated>
    <author>
        <name>Sylvain</name>
    </author>
    <id>https://www.sylvainmoingeon.fr</id>

    <entry>
        <title>De d√©veloppeur √† luthier, histoire d&#x27;une reconversion</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/de-developpeur-a-luthier-histoire-dune-reconversion/"/>
        <id>https://www.sylvainmoingeon.fr/de-developpeur-a-luthier-histoire-dune-reconversion/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/43/cover.webp" medium="image" />
            <category term="reconversion"/>
            <category term="luthier"/>
            <category term="lutherie"/>
            <category term="guitare"/>
            <category term="facture instrumentale"/>
            <category term="d√©veloppeur informatique"/>

        <updated>2024-08-20T19:43:05+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/43/cover.webp" alt="Illustration d&#x27;un article de blog sur la reconversion d&#x27;un d√©veloppeur informatique au m√©tier de la lutherie" />
                    Voil√† un peu plus d'une ann√©e que je n'ai √©crit une ligne&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/43/cover.webp" class="type:primaryImage" alt="Illustration d&#x27;un article de blog sur la reconversion d&#x27;un d√©veloppeur informatique au m√©tier de la lutherie" /></p>
                
  <p>
    Voil√† un peu plus d'une ann√©e que je n'ai √©crit une ligne de code ! Je vais y revenir promis, mais √† temps-partiel uniquement.
  </p>

  <p>
    Pourquoi √† temps-partiel ? C'est une longue remise en question qui a d√©but√©e en juin 2023 et j'aimerais en apporter le t√©moignage. Laissez-moi vous raconter l'histoire‚Ä¶
<br>
<br>Depuis plus de 15 ans je suis d√©veloppeur informatique. J'ai travaill√© en TPE, dans un grand groupe, en tant qu'ind√©pendant, puis dans une start-up. Mais comme cela arrive souvent, la start-up subit un (et m√™me plusieurs) mauvais coups et met la cl√© sous la porte.
<br>
<br>C'est ainsi que je me retrouve licenci√© √©conomique en juin 2023. Je pourrais, √©tant donn√© le march√© du travail dans mon domaine et mon expertise, retrouver rapidement un poste mais je d√©cide de profiter de la p√©riode de ch√¥mage pour sortir la t√™te du guidon et prendre un peu de recul. 
<br>
<br>Et ce que je d√©couvre n'est pas beau ! √áa craint !
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/burnout.webp" height="1024" width="1024" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/43/responsive/burnout-xs.webp 300w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/burnout-sm.webp 480w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/burnout-md.webp 768w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/burnout-lg.webp 1024w">
      
    </figure>

  <p>
    
<br>Bien qu'aimant mon job, je me rends compte que je ne suis absolument pas √©panoui. J'aime coder, d√©velopper, voir un projet √©voluer et prendre forme, mais les conditions de travail me rendent malades :
<br>
<br>Je ne supporte plus d'√™tre assis toute la journ√©e derri√®re un √©cran, √ßa me rend aigri, le soir je suis compl√®tement sous tension, la t√™te pr√™te √† exploser.
<br>
<br>Au fil du temps, mon corps d√©veloppe toutes sortes de troubles musculo-squelettiques, j'ai en permanence mal aux mains, aux coudes, au dos, aux hanches et aux genoux. 
<br>
<br>Tous les soirs, je passe plus d'une heure √† effectuer des exercices de mobilit√© et d'√©tirement pour r√©ussir √† att√©nuer la douleur. Sans quoi je ne dors pas la nuit. Tout ce temps, je pourrais le passer avec ma famille ou profiter de mes loisirs.
<br>
<br>En journ√©e je me rends √† mes s√©ances d'orthoptie parce qu'√† force de fixer un √©cran&nbsp; en permanence, mes yeux ont d√©velopp√© un strabisme et une incapacit√© √† se rel√¢cher. J'ai les yeux lourds et mal au cr√¢ne du matin au soir.
<br>
<br>Je me rends subitement compte que mes deux b√©b√©s sont des ados. Je ne les ai pas vu grandir.
<br>
<br>Et en plus, j'ai 45 ans, l'heure de la crise !
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/frustration.jpeg" height="1024" width="1024" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/43/responsive/frustration-xs.jpeg 300w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/frustration-sm.jpeg 480w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/frustration-md.jpeg 768w ,https://www.sylvainmoingeon.fr/media/posts/43/responsive/frustration-lg.jpeg 1024w">
      
    </figure>

  <p>
    Dans le cadre de mon licenciement, j'int√®gre le Contrat de S√©curisation Professionnel de Pole Travail (j'ai commenc√© avec l'un, termin√© avec l'autre) qui d√©l√®gue la t√¢che √† la soci√©t√© Solerys.
<br>
<br>A ce moment-l√†, je suis compl√®tement paum√©. Je ne sais plus o√π je suis, ni o√π je vais. Ni dans quel √©tat j'erre (j'ai le droit au "dad jokes", j'ai l'√¢ge et les enfants requis). J'ai un d√©gout profond des √©crans, je ne regarde m√™me plus la TV. Impossible pour moi de m'imaginer retourner dans l'informatique.
<br>
<br>Dans le brouillard total, je tourne en rond, je ne sais quoi faire. Ou plut√¥t, je sais trop quoi faire mais dans quelle direction me tourner ? Entre r√™ves inassouvis et nombreux centres d'int√©r√™ts, je me dis pourquoi pas ? Mais quoi ?
<br>
<br>Lors de mon suivi, j'ai la chance de tomber sur une consultante √† l'√©coute et ouverte (coucou Lydie). Lorsqu'elle me demande si j'ai des projets, je me surprends moi-m√™me √† lui en sortir toute une liste :
  </p>

  <ul>
    <li>Faire de la photo, une de mes passions laiss√©e √† l'abandon faute de temps</li><li>Capitaliser sur mes √©tudes scientifiques (BAC+5) pour revenir dans ce domaine<br></li><li>Me professionnaliser au niveau du sport (je suis animateur b√©n√©vole dans un club d'arts-martiaux)<br></li><li>Trouver une activit√© en lien avec la musique (passionn√© de guitare)<br></li><li>Me lancer dans un m√©tier manuel, tiens pourquoi pas en rapport avec la guitare (je me souviens √† cette occasion √™tre pass√© plusieurs fois devant des ateliers de luthier en soupirant "pourquoi pas moi ?")<br></li>
  </ul>

  <p>
    S'ensuit un accompagnement, avec bilan de comp√©tences, profil psychologique, recherche d'un point d'accroche entre mes centres d'int√©r√™ts, mes qualit√©s, mes aspirations et un √©ventuel projet professionnel.
<br>
<br>Et peu-√†-peu, celui-ci se dessine, la balance penche de plus en plus vers la lutherie.
<br>
<br>C'est ainsi que je me retrouve en formation dans un atelier de facture instrumentale jusqu'en aout 2024. Et c'est le bonheur total. :-)
  </p>

  <div  class="gallery-wrapper gallery-wrapper--wide">
    <div class="gallery" data-columns="3">
      <figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20231128_184139.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20231128_184139-thumbnail.jpg" height="576" width="768" alt="Des instruments de musique pendus au plafond dans un atelier de lutherie" >
      </a>
      <figcaption>Ambiance au centre de formation</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20231129_112248.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20231129_112248-thumbnail.jpg" height="576" width="768" alt="Photo illustrant des moules utilis√©s pour fabriquer des guitares" >
      </a>
      <figcaption>Une belle collection de moules</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240301_095101.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240301_095101-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le cintrage d'une √©clisse" >
      </a>
      <figcaption>Un pan coup√© qui m'a donn√© du fil (ou plut√¥t du bois) √† retordre</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240301_160706.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240301_160706-thumbnail.jpg" height="576" width="768" alt="" >
      </a>
      
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240402_154406.jpg" data-size="2576x1932">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240402_154406-thumbnail.jpg" height="576" width="768" alt="Photo illustrant un ciseau √† bois affleurant un filet dans une rosace de guitare" >
      </a>
      <figcaption>Affleurage d'un filet de rosace</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240404_165316.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240404_165316-thumbnail.jpg" height="576" width="768" alt="Photo illustrant un collage au ciel" >
      </a>
      <figcaption>Collage au ciel</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240405_162705.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240405_162705-thumbnail.jpg" height="576" width="768" alt="Photo illustrant les barrages de table d'harmonie dans une guitare" >
      </a>
      <figcaption>Pr√©sentation de la table d'harmonie sous les √©clisses. Ne paniquez pas les puristes, les barrages ne sont pas encore ajust√©s ni scalop√©s</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240411_165205.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240411_165205-thumbnail.jpg" height="576" width="768" alt="Photo illustrant une vielle √† roue de 1742 et sa r√©plique exacte" >
      </a>
      <figcaption>Une tr√®s vieille vielle (1742) et sa r√©plique en vue de conservation</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240513_175718.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240513_175718-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le collage des filets d'√©clisse sur une guitare classique" >
      </a>
      <figcaption>Collage des filets avec la technique ultra moderne et sophistiqu√©e des "bouts de scotch"</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240516_121424.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240516_121424-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le chanfrein de confort d'une guitare classique" >
      </a>
      <figcaption>Chanfrein de confort</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240607_152241.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240607_152241-thumbnail.jpg" height="576" width="768" alt="Photo illustrant un luthier travaillant au racloir" >
      </a>
      <figcaption>On s'occupe du sillon interfessier de la guitare (vocabulaire tr√®s officiel, il va sans dire)</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240613_120653.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240613_120653-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le profilage d'un manche de guitare" >
      </a>
      <figcaption>Profilage du manche</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240613_161832.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240613_161832-thumbnail.jpg" height="576" width="768" alt="Photo illustrant l'emboitement du manche sur la caisse" >
      </a>
      <figcaption>Emboitement du manche sur la caisse</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_164653.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_164653-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le talon de la guitare" >
      </a>
      <figcaption>D√©coration du talon en √©rable pour la continuit√© avec les filets</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_164717.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_164717-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le talon de la guitare" >
      </a>
      <figcaption>D√©coration du talon en √©rable pour la continuit√© avec les filets</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_175523.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240621_175523-thumbnail.jpg" height="576" width="768" alt="Photo illustrant une guitare assembl√©e mais pas encore termin√©e" >
      </a>
      <figcaption>√áa semble presque termin√©, mais comme en informatique, quand c'est presque fini, √ßa ne fait que commencer !</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240627_111132.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240627_111132-thumbnail.jpg" height="576" width="768" alt="Photo illustrant l'usinage d'un chevalet de guitare" >
      </a>
      <figcaption>Usinage du chevalet</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240702_162427.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240702_162427-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le chevalet termin√©" >
      </a>
      <figcaption>Le chevalet pr√™t √† √™tre pos√©</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240705_110756.jpg" data-size="4624x3468">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/43/gallery/20240705_110756-thumbnail.jpg" height="576" width="768" alt="Photo illustrant le collage du chevalet" >
      </a>
      <figcaption>Collage du chevalet (la guitare a √©t√© vernie entre temps)</figcaption>
    </figure>
    </div>
  </div>

  <p>
    Enfin, nonobstant l'√©loignement de ma famille (ce n'est pas √† c√¥t√© de chez moi) et les frais consid√©rables, en moyenne 500‚Ç¨ par mois pour le logement et le carburant. Quand on vit sur les allocations ch√¥mage, √ßa pique. Mais toucher son r√™ve du bout du doigt m√©rite bien quelques sacrifices, n'est-ce pas ?
<br>
<br>J'y apprends le travail du bois, les bases de la fabrication d'instruments, en commen√ßant petit (Ukul√©l√©), puis viennent les guitares classiques et √©lectriques. J'y vois aussi des techniques de r√©parations/restauration. Du r√©glage, mais √ßa je savais d√©j√† faire. J'y d√©couvre des instruments que je connaissais peu (balala√Øka, bouzouki, vielle √† roue) et d'autres qui m'√©taient parfaitement inconnus (Nickelharpa).
<br>
<br>J'apprends, je d√©couvre, j'explore et je cr√©e. Mes activit√©s pr√©f√©r√©es en somme. Je me rends d'ailleurs compte que c'est aussi, au d√©part, ce qui m'avait pouss√© dans le d√©veloppement logiciel. Ce n'est pas coder qui m'attirait, mais apprendre de nouvelles techniques, les appliquer pour construire quelque chose de nouveau. Observer un logiciel "pousser" sous mes yeux. Et avec le recul, je me rends compte que c'est la m√™me pour la photo et l'enseignement des arts-martiaux : apprendre et appliquer ce que j'ai appris pour construire quelque chose de nouveau !<br>
<br>Aurai-je d√©couvert mon Ikiga√Ø ?
<br>
<br>Mais voil√†, le temps de la formation est r√©volu, mes pieds redescendent lentement sur terre. Il me reste 3 mois d'allocations ch√¥mage et je sais pertinemment qu'il me faudra du temps avant d'√™tre rentable en tant que luthier et avoir une activit√© p√©renne.
  </p>

  <p>
    Je reviens donc √† la r√©alit√© : un travail que je sais faire qui paie bien et la lutherie comme compl√©ment. D'autant que ma conjointe est elle-m√™me artisan et deux m√©tiers ind√©pendants pour une famille avec enfants, c'est trop dangereux. On en a fait les frais pendant la crise du covid (j'√©tais Freelance √† cette √©poque), autant assurer un minimum de s√©curit√© pour au moins l'un des deux.&nbsp;<br>
<br>Voil√† pourquoi, apr√®s une ann√©e de remise en question, je suis de nouveau √† l'√©coute d‚Äôopportunit√©s, √† partir du mois de d√©cembre et √† temps-partiel uniquement. 
<br>
<br>Dans le d√©veloppement informatique de pr√©f√©rence, puisque c'est mon domaine d'expertise, mais apr√®s tout, je reste r√©ceptif √† d'autres propositions, cette derni√®re ann√©e ayant eu l'effet de consid√©rablement m'ouvrir l'esprit.
  </p>

  <p>
    Mon atelier de lutherie est en cours d'am√©nagement, on m'a d√©j√† confi√© une guitare √† restaurer et j'en ai une en cours de fabrication (pas une commande malheureusement, c'est pour exposer).
  </p>

  <p>
    Mais d'ici √† ce que √ßa m'occupe √† plein temps, il y a, je pense, mati√®re √† ce que je participe activement √† d'autres projets. üòâ
  </p>

  <p>
    Un d√©veloppeur qui fabrique des guitares, qui a des r√™ves et se donne les moyens de les r√©aliser, √ßa vous int√©resse ? contactez-moi !
  </p>

  <p>
    Un luthier qui a l'esprit cart√©sien, le sens du d√©tail et l'esprit d'analyse d'un d√©veloppeur informatique, √ßa vous int√©resse ? contactez-moi aussi, c'est le m√™me mec !
  </p>

  <p>
    Bien merci √† toi qui a tout lu jusqu'ici !
<br>
<br>Ah, et oui, zut : like, partage et tout √ßa, hein.
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Authentification Azure Directory B2C dans une application Xamarin.Forms</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/authentification-azure-directory-b2c-dans-une-application-xamarinforms/"/>
        <id>https://www.sylvainmoingeon.fr/authentification-azure-directory-b2c-dans-une-application-xamarinforms/</id>
            <category term="Xamarin.Forms"/>
            <category term="Azure"/>
            <category term="Active Directory B2C"/>

        <updated>2021-03-19T18:21:07+01:00</updated>
            <summary>
                <![CDATA[
                    <p>On m‚Äôa r√©cemment demand√© d‚Äô√©tudier la faisabilit√© d‚Äôune authentification depuis Azure Directory B2C dans une application Xamarin.Forms.</p><p>La documentation officielle a un peu tendance √† tourner en rond avec des liens en r√©f√©rences circulaires, le portail Azure est vaste et pas super user-friendly (on peut passer beaucoup de temps √† chercher une option qu‚Äôon est pourtant certain d‚Äôavoir aper√ßue cinq minutes plus t√¥t‚Ä¶).</p><p>J‚Äôai donc r√©dig√© un guide rapide √† l‚Äôattention des d√©veloppeurs de l‚Äô√©quipe, je vous le livre tel quel, ce n‚Äôest donc pas n√©cessairement tr√®s bien r√©dig√©, mais vous aurez toutes les informations pour d√©buter, depuis la cr√©ation du <em>Directory B2C</em> sur Azure jusqu‚Äô√† l‚Äôauthentification et la r√©cup√©ration des donn√©es de l‚Äôutilisateur dans l‚Äôapplication Xamarin.Forms.</p>
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>On m‚Äôa r√©cemment demand√© d‚Äô√©tudier la faisabilit√© d‚Äôune authentification depuis Azure Directory B2C dans une application Xamarin.Forms.</p><p>La documentation officielle a un peu tendance √† tourner en rond avec des liens en r√©f√©rences circulaires, le portail Azure est vaste et pas super user-friendly (on peut passer beaucoup de temps √† chercher une option qu‚Äôon est pourtant certain d‚Äôavoir aper√ßue cinq minutes plus t√¥t‚Ä¶).</p><p>J‚Äôai donc r√©dig√© un guide rapide √† l‚Äôattention des d√©veloppeurs de l‚Äô√©quipe, je vous le livre tel quel, ce n‚Äôest donc pas n√©cessairement tr√®s bien r√©dig√©, mais vous aurez toutes les informations pour d√©buter, depuis la cr√©ation du <em>Directory B2C</em> sur Azure jusqu‚Äô√† l‚Äôauthentification et la r√©cup√©ration des donn√©es de l‚Äôutilisateur dans l‚Äôapplication Xamarin.Forms.</p>

<h1 id="r√©sum√©">R√©sum√©</h1>
<ol>
<li>Cr√©er un tenant <em>Active Directory B2C</em> dans Azure.</li>
<li>Enregistrer l‚Äôapplication mobile dans le tenant <em>Active Directory B2C</em>.</li>
<li>Cr√©er des <em>User Flows</em> avec des polices de <em>Signin</em>, r√©initialisation de mot de passe‚Ä¶</li>
<li>Utiliser la <em>Microsoft Authentication Library (MSAL)</em> pour g√©rer le flux d‚Äôauthentification dans l‚Äôapplication.</li>
</ol>
<h2 id="sources">Sources</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/data-cloud/authentication/azure-ad-b2c">Authenticate Users with Azure Active Directory B2C</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/active-directory-b2c/tutorial-create-tenant">Tutorial: Create an Azure Active Directory B2C tenant</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/active-directory-b2c/tutorial-register-applications?tabs=app-reg-ga">Tutorial: Register a web application in Azure Active Directory B2C</a></li>
</ul>
<h1 id="c√¥t√©-serveur">C√¥t√© serveur</h1>
<h2 id="cr√©ation-du-compte-azure">Cr√©ation du compte Azure</h2>
<p><a href="https://aka.ms/azfree-docs-mobileapps">https://aka.ms/azfree-docs-mobileapps</a></p><p>Pr√©-requis :</p><ul>
<li>Un compte microsoft</li>
<li>Une carte bancaire</li>
</ul>
<p>Je ne d√©taille pas, il suffit de suivre les √©tapes. Sachez simplement que vous disposez d‚Äôun cr√©dit de 170‚Ç¨ pour d√©buter, de quoi faire des tests et de l‚Äôautoformation.</p><h2 id="configuration-du-portail-en-anglais">Configuration du portail en ANGLAIS</h2>
<p>Tr√®s important, peut-√™tre un bug temporaire, mais si vous conservez le portail en fran√ßais, la cr√©ation de AD B2C √©chouera avec un message abscons vous indiquant que la valeur de <em>l‚Äôemplacement du groupe de ressource</em> est invalide alors qu‚Äôon la s√©lectionne dans une liste (et peu importe la valeur s√©lectionn√©e) !</p><p>C‚Äôest simplement que la liste est traduite et que visiblement quelque part dans le code, Azure attend une valeur en dur tir√©e de la liste en anglais. Franchement, j‚Äôai honte pour Microsoft !</p><p>Donc √©vitons-nous bien des soucis et passons imm√©diatement le portail en anglais.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/6ce4a4c4b1004751bddf92e7f88a9f98.png" alt="Configuration du portail en anglais"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/6ce4a4c4b1004751bddf92e7f88a9f98-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/6ce4a4c4b1004751bddf92e7f88a9f98-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/6ce4a4c4b1004751bddf92e7f88a9f98-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/6ce4a4c4b1004751bddf92e7f88a9f98-lg.png 1024w"></figure></p><h2 id="enregistrement-du-namespace-mirosoftazureactivedirectory">Enregistrement du namespace <em>Mirosoft.AzureActiveDirectory</em></h2>
<p>Aucun tuto ne vous le dira, et c‚Äôest peut-√™tre un bug temporaire, mais si vous ne le faites pas maintenant, vous obtiendrez cette erreur √† la toute fin du processus et vous devrez tout recommencer. :-)</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/eae4e6e303ba45cfaf377ae3ab2f522e.png" alt="Message d&#39;erreur concernant Microsoft.AzureActiveDirectory"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/eae4e6e303ba45cfaf377ae3ab2f522e-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eae4e6e303ba45cfaf377ae3ab2f522e-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eae4e6e303ba45cfaf377ae3ab2f522e-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eae4e6e303ba45cfaf377ae3ab2f522e-lg.png 1024w"></figure><p><strong>Cliquez sur <em>Subscriptions</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/d821b9e2f1a84d46b574a439df9c1fc9.png" alt="Navigation vers les subscriptions"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/d821b9e2f1a84d46b574a439df9c1fc9-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/d821b9e2f1a84d46b574a439df9c1fc9-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/d821b9e2f1a84d46b574a439df9c1fc9-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/d821b9e2f1a84d46b574a439df9c1fc9-lg.png 1024w"></figure></p><p><strong>Dans la liste, s√©lectionnez votre subscription courante.</strong></p><p>Si vous venez de cr√©er un compte gratuit, il n‚Äôy en aura qu‚Äôune :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/13427f5008fb459db2ea5276dd729262.png" alt="S√©lection de la subscription"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/13427f5008fb459db2ea5276dd729262-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/13427f5008fb459db2ea5276dd729262-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/13427f5008fb459db2ea5276dd729262-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/13427f5008fb459db2ea5276dd729262-lg.png 1024w"></figure></p><p><strong>Dans le panneau de gauche, cliquez sur <em>Resource providers</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/979a2d1abb4a48b59a7bf9ad8486880f.png" alt="Navigation vers les resource providers"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/979a2d1abb4a48b59a7bf9ad8486880f-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/979a2d1abb4a48b59a7bf9ad8486880f-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/979a2d1abb4a48b59a7bf9ad8486880f-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/979a2d1abb4a48b59a7bf9ad8486880f-lg.png 1024w"></figure></p><p><strong>Cherchez Azure, s√©lectionnez <em>Microsoft.AzureActiveDirectory</em> et <strong>cliquez sur Register</strong></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/8fa48e6076574a9eb090837d9231fd87.png" alt="Recherche de Microsoft.AzureActiveDirectory"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fa48e6076574a9eb090837d9231fd87-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fa48e6076574a9eb090837d9231fd87-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fa48e6076574a9eb090837d9231fd87-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fa48e6076574a9eb090837d9231fd87-lg.png 1024w"></figure></p><p>Patientez‚Ä¶ patientez‚Ä¶ patientez‚Ä¶ patientez‚Ä¶
Cliquez de temps en temps sur <em>Refresh</em> au cas o√π.
Si √ßa ne fonctionne pas, recommencez (s√©lection, register), au bout d‚Äôun moment √ßa finit par passer. :-)
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/941ed15f975649aca20eeb624c4192fd.png" alt="Microsoft.AzureActiveDirectory est enregistr√©"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/941ed15f975649aca20eeb624c4192fd-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/941ed15f975649aca20eeb624c4192fd-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/941ed15f975649aca20eeb624c4192fd-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/941ed15f975649aca20eeb624c4192fd-lg.png 1024w"></figure></p><p>C‚Äôest bon, on y est, on peut commencer !</p><h2 id="cr√©ation-de-lactive-directory-b2c">Cr√©ation de l‚ÄôActive Directory B2C</h2>
<p><strong>Cliquez sur <em>Create a resource</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/26cd2d69e0cf4e2c9533a45c7ef1e726.png" alt="Cr√©er une ressources"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/26cd2d69e0cf4e2c9533a45c7ef1e726-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/26cd2d69e0cf4e2c9533a45c7ef1e726-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/26cd2d69e0cf4e2c9533a45c7ef1e726-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/26cd2d69e0cf4e2c9533a45c7ef1e726-lg.png 1024w"></figure></p><p><strong>Cherchez et s√©lectionnez <em>Active Directory B2C</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/3734c6c0c609497b8523c2ac5ee56045.png" alt="S√©lectionner Active Directory B2C"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/3734c6c0c609497b8523c2ac5ee56045-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/3734c6c0c609497b8523c2ac5ee56045-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/3734c6c0c609497b8523c2ac5ee56045-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/3734c6c0c609497b8523c2ac5ee56045-lg.png 1024w"></figure></p><p><strong>Cliquez sur <em>Create</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/8fb8757ce94343aea6ddb6b375e139ac.png" alt="Cliquer sur Create"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fb8757ce94343aea6ddb6b375e139ac-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fb8757ce94343aea6ddb6b375e139ac-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fb8757ce94343aea6ddb6b375e139ac-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/8fb8757ce94343aea6ddb6b375e139ac-lg.png 1024w"></figure></p><p><strong>Create a New Azure AD B2C tenant</strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/0f44978924974827b83e5498624e1827.png" alt="Create a New Azure AD B2C tenant"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/0f44978924974827b83e5498624e1827-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0f44978924974827b83e5498624e1827-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0f44978924974827b83e5498624e1827-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0f44978924974827b83e5498624e1827-lg.png 1024w"></figure></p><p><strong>Renseignez les informations du tenant</strong></p><p>Cr√©er un <em>Groupe de ressources</em> avec le lien <em>Create New</em> s‚Äôil n‚Äôen existe pas d√©j√† un.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/bfa01cbf52b14c7b9969c162f08e83ba.png" alt="Renseigner les informations du tenant"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/bfa01cbf52b14c7b9969c162f08e83ba-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bfa01cbf52b14c7b9969c162f08e83ba-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bfa01cbf52b14c7b9969c162f08e83ba-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bfa01cbf52b14c7b9969c162f08e83ba-lg.png 1024w"></figure></p><p><strong>Cliquez sur <em>Review + Create</em> pour valider les informations</strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/eeac2be3682d457dae69874ee0e04525.png" alt="Valider les informations"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/eeac2be3682d457dae69874ee0e04525-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eeac2be3682d457dae69874ee0e04525-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eeac2be3682d457dae69874ee0e04525-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/eeac2be3682d457dae69874ee0e04525-lg.png 1024w"></figure></p><p><strong>Cliquez sur <em>Create</em> pour en finir !</strong></p><p>Patientez. Tant que √ßa gigote l√†-dedans c‚Äôest que √ßa bosse :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/2fdbea7151f948278ae450c27839495d.png" alt="Indicateur d&#39;activit√© dans la toolbar"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/2fdbea7151f948278ae450c27839495d-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/2fdbea7151f948278ae450c27839495d-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/2fdbea7151f948278ae450c27839495d-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/2fdbea7151f948278ae450c27839495d-lg.png 1024w"></figure></p><p>Cliquez sur le lien, bienvenue √† Black Mesa !
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/000cf65ea90e48b0b774d8405119b298.png" alt="Lien menant vers votre tenant Active Directory B2C"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/000cf65ea90e48b0b774d8405119b298-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/000cf65ea90e48b0b774d8405119b298-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/000cf65ea90e48b0b774d8405119b298-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/000cf65ea90e48b0b774d8405119b298-lg.png 1024w"></figure></p><h2 id="configuration-dune-application-c√¥t√©-serveur">Configuration d‚Äôune <em>application</em> c√¥t√© serveur</h2>
<h3 id="selection-du-tenant-b2c">Selection du tenant B2C</h3>
<p>Dans la toolbar en haut √† droite, trouvez le bouton qui ressemble √† un carnet avec un entonnoir :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/0dc10f53aef94e8cb578f3eb0351b5bc.png" alt="Buton de s√©lection des directories"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/0dc10f53aef94e8cb578f3eb0351b5bc-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0dc10f53aef94e8cb578f3eb0351b5bc-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0dc10f53aef94e8cb578f3eb0351b5bc-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/0dc10f53aef94e8cb578f3eb0351b5bc-lg.png 1024w"></figure></p><p>Mais en principe vous devriez d√©j√† √™tre dessus si vous avez cliqu√© sur le lien √† la fin de l‚Äô√©tape pr√©c√©dente.</p><p>Si vous vous retrouvez sur une page d‚Äôaccueil comme √ßa et que vous ne retrouvez pas votre <em>tenant AD B2C</em>‚Ä¶
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/619e486c4a054f2cb3ee928a143a1963.png" alt="Page d&#39;accueil du Directory"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/619e486c4a054f2cb3ee928a143a1963-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/619e486c4a054f2cb3ee928a143a1963-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/619e486c4a054f2cb3ee928a143a1963-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/619e486c4a054f2cb3ee928a143a1963-lg.png 1024w"></figure></p><p>Saisissez simplement <em>B2C</em> dans la barre de recherche en haut et dans la rubrique <em>Services</em>, s√©lectionnez <em>Azure AD B2C</em>.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/636efe75e666412e9c7584f700c45f51.png" alt="Recherche du tenant B2C"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/636efe75e666412e9c7584f700c45f51-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/636efe75e666412e9c7584f700c45f51-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/636efe75e666412e9c7584f700c45f51-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/636efe75e666412e9c7584f700c45f51-lg.png 1024w"></figure></p><h3 id="enregistrement-de-lapplication">Enregistrement de l‚Äôapplication</h3>
<p><strong>S√©lectionnez <em>App registrations</em>‚Ä¶</strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/1c9cbee5394f46a397a8efbdcf1dc132.png" alt="Navigation vers l&#39;enregistrement d&#39;applications"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/1c9cbee5394f46a397a8efbdcf1dc132-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1c9cbee5394f46a397a8efbdcf1dc132-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1c9cbee5394f46a397a8efbdcf1dc132-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1c9cbee5394f46a397a8efbdcf1dc132-lg.png 1024w"></figure></p><p><strong>Puis <em>New registration</em></strong>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/5f5448c2423e48b4bdbc92b536d2453d.png" alt="Nouvel enregistrement"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/5f5448c2423e48b4bdbc92b536d2453d-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/5f5448c2423e48b4bdbc92b536d2453d-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/5f5448c2423e48b4bdbc92b536d2453d-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/5f5448c2423e48b4bdbc92b536d2453d-lg.png 1024w"></figure></p><p><strong>Renseignez les informations</strong></p><ul>
<li><p><em>Nom</em> et <em>type de compte</em> support√© :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/ebba5c97abd241ac81af607acb811a19.png" alt="Nom et type de compte"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/ebba5c97abd241ac81af607acb811a19-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ebba5c97abd241ac81af607acb811a19-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ebba5c97abd241ac81af607acb811a19-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ebba5c97abd241ac81af607acb811a19-lg.png 1024w"></figure></p></li>
<li><p><em>Redirect URI</em> :
  Cela d√©pend du type d‚Äôapplication (application mobile, web app‚Ä¶).
  Dans notre cas, il s‚Äôagira d‚Äôune application mobile Xamarin.Forms.
  <strong>Attention, l‚Äôuri r√©pond √† un sch√©ma bien particulier :</strong>
  <code>msal[redirect_uri]://auth</code>.
  <figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/f551892b4b9f48a8973694ff7473b391.png" alt="Redirect URi"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/f551892b4b9f48a8973694ff7473b391-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f551892b4b9f48a8973694ff7473b391-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f551892b4b9f48a8973694ff7473b391-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f551892b4b9f48a8973694ff7473b391-lg.png 1024w"></figure></p></li>
</ul>
<p>Cet URi sera √† renseigner dans les manifestes Android et iOS.</p><ul>
<li><em>Permissions :</em></li>
</ul>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/f6990694e50e4f59bbf304ab240ed75f.png" alt="Permisssions"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/f6990694e50e4f59bbf304ab240ed75f-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f6990694e50e4f59bbf304ab240ed75f-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f6990694e50e4f59bbf304ab240ed75f-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f6990694e50e4f59bbf304ab240ed75f-lg.png 1024w"></figure><p>Validez le tout en cliquant sur le bouton <em>Register</em>.
Bravo ! Votre application est enregistr√©e :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/21fa88ac0c1e4b8d97cba7c22496698f.png" alt="Application enregistr√©e"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/21fa88ac0c1e4b8d97cba7c22496698f-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/21fa88ac0c1e4b8d97cba7c22496698f-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/21fa88ac0c1e4b8d97cba7c22496698f-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/21fa88ac0c1e4b8d97cba7c22496698f-lg.png 1024w"></figure></p><h3 id="mais-ce-nest-pas-fini--la-case-√†-cocher-secr√®te">Mais ce n‚Äôest pas fini : la case √† cocher secr√®te</h3>
<p>Si vous vous en tenez l√† et suivez le tuto Microsoft et l‚Äôapplication <em>Sample</em> fournie, cela ne fonctionnera pas : les URI utilis√©s comme point d‚Äôacc√®s dans l‚Äôapplication ne sont pas autoris√©s par d√©faut !</p><p>Rendez-vous dans la rubrique <em>Authentication</em> et cochez les cases :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/cde6cd6048fa407e81ed0c4ba8559687.png" alt="Cocher les Uri d&#39;authentification"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/cde6cd6048fa407e81ed0c4ba8559687-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cde6cd6048fa407e81ed0c4ba8559687-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cde6cd6048fa407e81ed0c4ba8559687-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cde6cd6048fa407e81ed0c4ba8559687-lg.png 1024w"></figure></p><p>Pensez bien √† sauvegarder. Le bouton en haut, je vous laisse le trouver tout seul.</p><h3 id="cr√©ation-des-user-flows">Cr√©ation des <em>User Flows</em></h3>
<p>Cr√©er un <em>user flow</em> revient √† autoriser les utilisateurs √† interagir avec leur compte AD : se connecter, r√©initialiser son mot de passe, modifier son profile‚Ä¶</p><p>NB : les flows sont partageables entre les applications.</p><h4 id="sign-in">Sign In</h4>
<p>Au minima, les utilisateurs auront besoin de se connecter.
Dans la page de votre <em>tenant AD B2C</em>, allez sur <em>User flows</em> dans la rubrique <em>Policies</em> et cliquez sur <em>New user flow</em>.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/ff407a8e293349ff8cc82e83e5a3e4c7.png" alt="New User Flow"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff407a8e293349ff8cc82e83e5a3e4c7-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff407a8e293349ff8cc82e83e5a3e4c7-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff407a8e293349ff8cc82e83e5a3e4c7-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff407a8e293349ff8cc82e83e5a3e4c7-lg.png 1024w"></figure></p><p>Puis s√©lectionnez <em>Sign In</em> et cr√©ez le flow dans sa version recommand√©e.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/436019a0fe0643ebbcb99156b00edbbe.png" alt="Signin User Flow"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/436019a0fe0643ebbcb99156b00edbbe-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/436019a0fe0643ebbcb99156b00edbbe-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/436019a0fe0643ebbcb99156b00edbbe-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/436019a0fe0643ebbcb99156b00edbbe-lg.png 1024w"></figure></p><p>Renseignez les informations en fonction du mode de connexion et de l‚Äôauthentification multiple souhait√©s.</p><p>Notez bien le nom, vous en aurez besoin c√¥t√© client :
<figure class="post__image"><img decoding="async" src="https://www.sylvainmoingeon.fr/media/posts/42/67382c4d40224b36a0f04c9054364cae.png" alt="Nom de la police"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/67382c4d40224b36a0f04c9054364cae-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/67382c4d40224b36a0f04c9054364cae-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/67382c4d40224b36a0f04c9054364cae-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/67382c4d40224b36a0f04c9054364cae-lg.png 1024w"></figure></p><p>La derni√®re rubrique permet de s√©lectionner les donn√©es qui seront r√©cup√©r√©es c√¥t√© client lors de la connexion utilisateur. Cliquez sur <em>Show more‚Ä¶</em> pour obtenir la liste compl√®te.</p><figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/f65a66c9662f40dc9aaf15676ed7bd5a.png" alt="Claims"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/f65a66c9662f40dc9aaf15676ed7bd5a-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f65a66c9662f40dc9aaf15676ed7bd5a-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f65a66c9662f40dc9aaf15676ed7bd5a-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/f65a66c9662f40dc9aaf15676ed7bd5a-lg.png 1024w"></figure><p>Finalisez en cliquant sur le bouton <em>Create</em>.</p><h4 id="autres-flows">Autres flows</h4>
<p>La proc√©dure est similaire pour les autres types de <em>flows</em>. Cr√©ez ceux dont vous avez besoin.</p><h3 id="cr√©ation-des-utilisateurs">Cr√©ation des utilisateurs</h3>
<p>Sur la page de votre <em>tenant Azure AD B2C</em>, cliquez sur <em>Users</em> dans la rubrique <em>Manage</em>.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/ce85fccb56374fcab27e51b008093cde.png" alt="Cr√©ation des utilisateurs"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/ce85fccb56374fcab27e51b008093cde-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ce85fccb56374fcab27e51b008093cde-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ce85fccb56374fcab27e51b008093cde-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ce85fccb56374fcab27e51b008093cde-lg.png 1024w"></figure></p><p>Ensuite, cela d√©pend du mode de connexion envisag√©.
Il sera peut-√™tre n√©cessaire de d‚Äôabord configurer un ou plusieurs fournisseurs d‚Äôidentit√© (compte Microsoft, compte local, Github, Facebook‚Ä¶), dans la m√™me rubrique que pr√©c√©demment, lien <em>Identity providers</em>.</p><p>A priori, tout est en place c√¥t√© serveur, reste √† impl√©menter la couche MSAL c√¥t√© client.</p><h1 id="c√¥t√©-client">C√¥t√© client</h1>
<h2 id="package-nuget-microsoft-authentication-library-msal">Package nuget <em>Microsoft Authentication Library (MSAL)</em></h2>
<p>Direction le nuget package manager.
Installez <em>Microsoft.Identity.Client</em> sur le projet commun et les projets des plateformes :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/bf2ed89bfb2644a79b5f1cd0c9857761.png" alt="Package nuget Microsoft.Identity.Client"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/bf2ed89bfb2644a79b5f1cd0c9857761-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bf2ed89bfb2644a79b5f1cd0c9857761-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bf2ed89bfb2644a79b5f1cd0c9857761-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bf2ed89bfb2644a79b5f1cd0c9857761-lg.png 1024w"></figure></p><h2 id="pr√©paration-du-projet-commun">Pr√©paration du projet commun</h2>
<h3 id="d√©finition-de-quelques-constantes">D√©finition de quelques constantes</h3>
<p>Pour commencer, il est n√©cessaire de d√©finir quelques constantes.</p><ul>
<li><p><code>tenantName</code> : le nom de domaine que vous avez d√©fini pour votre tenant Directory B2C</p></li>
<li><p><code>tenantId</code> : le m√™me suffix√© par <code>.onmicrosoft.com</code></p></li>
<li><p><code>clientId</code> : <em>Application (client) Id</em>, vous trouverez cette information dans l‚Äô<em>overview</em> de votre application sur le portail Azure :
  <figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/99664b9fc9504d75b03489fffe708bfe.png" alt="ClientId dans l&#39;overview de l&#39;application"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/99664b9fc9504d75b03489fffe708bfe-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/99664b9fc9504d75b03489fffe708bfe-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/99664b9fc9504d75b03489fffe708bfe-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/99664b9fc9504d75b03489fffe708bfe-lg.png 1024w"></figure></p></li>
<li><p><code>redirect_uri</code> : l‚Äôuri enregistr√© c√¥t√© azure</p></li>
<li><p><code>policySignin</code> et <code>policyPassword</code> : le nom des polices telles que vous les avez d√©finies pr√©c√©demment</p></li>
<li><p><code>iosKeychainSecurityGroup</code> : identifiant du Bundle iOS que vous trouvez dans <code>Info.plist</code>.</p></li>
</ul>
<pre><code class="language-csharp">public static class Constants
{
    const string tenantName = &quot;[your_tenant_name]&quot;;
    const string tenantId = &quot;[your_tenant_name].onmicrosoft.com&quot;;
    const string clientId = &quot;[your_application_client_id]&quot;;
    const string redirectUri = &quot;[redirect_uri]&quot;;
    const string policySignin = &quot;B2C_1_signin&quot;;
    const string policyPassword = &quot;B2C_1_resetpassword&quot;;
    const string iosKeychainSecurityGroup = &quot;[application iOS Bundle identifier]&quot;;
    
    static readonly string[] scopes = { &quot;&quot; };
    static readonly string authorityBase = $&quot;https://{tenantName}.b2clogin.com/tfp/{tenantId}/&quot;;

    public static string RedirectMsalScheme =&gt; $&quot;msal{redirectUri}://auth&quot;; 
    public static string AuthorityBase =&gt; authorityBase;
    public static string[] Scopes =&gt; scopes;
    public static string PolicySignin =&gt; policySignin;
    public static string PolicyPassword =&gt; policyPassword;
    public static string IosKeychainSecurityGroups =&gt; iosKeychainSecurityGroup;
    public static string ClientId =&gt; clientId;
    public static string AuthoritySignin =&gt; $&quot;{authorityBase}{policySignin}&quot;;
    public static string AuthorityPasswordReset =&gt; $&quot;{authorityBase}{policyPassword}&quot;;
}
</code></pre>
<h3 id="le-service-dauthentification--authenticationclient">Le service d‚Äôauthentification : <code>AuthenticationClient</code></h3>
<p>Dans le fichier <code>App.xaml.cs</code>, d√©finir les propri√©t√©s <code>AppUi</code> (n√©cessaire pour l‚Äôimpl√©mentation dans Android) et <code>AuthenticationClient</code> :</p><pre><code class="language-csharp">using Microsoft.Identity.Client;
[...]

public partial class App : Application
{
    public static IPublicClientApplication AuthenticationClient { get; private set; }
    public static object UIParent { get; set; } = null;
    
    [...]
}
</code></pre>
<p>Le service d‚Äôauthentification impl√©mente <code>IPublicClientApplication</code>, pour l‚Äôinstancier, on utilise le builder <code>PublicClientApplicationBuilder</code> :</p><pre><code class="language-csharp">public App()
{
    InitializeComponent();

    AuthenticationClient = PublicClientApplicationBuilder.Create(Constants.ClientId)
            .WithIosKeychainSecurityGroup(Constants.IosKeychainSecurityGroups)
            .WithB2CAuthority(Constants.AuthoritySignin)
            .WithRedirectUri(Constants.RedirectMsalScheme)
            .Build();
    [...]
}
</code></pre>
<h2 id="configuration-de-lapplication-ios">Configuration de l‚Äôapplication iOS</h2>
<h3 id="infoplist">Info.plist</h3>
<p>Souvenez-vous c√¥t√© serveur, vous avez configur√© un <em>Redirect Uri</em> sous la forme <code>msal[redirect_uri]://auth</code></p><p>Il s‚Äôagit ici de renseigner cette valeur dans le fichier Info.plist du projet iOS.
Cela se passe dans l‚Äôonglet <em>Advanced</em>, rubrique <em>URL Types</em> :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/e69e5ca4a86d40aaba291deee5c60caf.png" alt="Redirect Uri dans Info.plist"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/e69e5ca4a86d40aaba291deee5c60caf-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/e69e5ca4a86d40aaba291deee5c60caf-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/e69e5ca4a86d40aaba291deee5c60caf-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/e69e5ca4a86d40aaba291deee5c60caf-lg.png 1024w"></figure></p><h3 id="keychain-dans-entitlementsplist">Keychain dans Entitlements.plist</h3>
<p>Il est ensuite n√©cessaire d‚Äôenregistrer un Keychain dans <em>Entitlements.plist</em> :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/ed660e0f6cf54409b5237432c27a3909.png" alt="Keychain dans Entitlements.plist"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/ed660e0f6cf54409b5237432c27a3909-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ed660e0f6cf54409b5237432c27a3909-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ed660e0f6cf54409b5237432c27a3909-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ed660e0f6cf54409b5237432c27a3909-lg.png 1024w"></figure></p><p>Si cela ne s‚Äôest pas fait automatiquement, v√©rifiez bien que le fichier <em>Entitlements.plist</em> est s√©lectionn√© comme <em>Custom Entitlements</em> dans l‚Äôonglet <em>iOS Bundle Signing</em> du projet iOS.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/bd0f850cd2e8445688885dbc6c689b59.png" alt="Custom Entitlements"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/bd0f850cd2e8445688885dbc6c689b59-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bd0f850cd2e8445688885dbc6c689b59-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bd0f850cd2e8445688885dbc6c689b59-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bd0f850cd2e8445688885dbc6c689b59-lg.png 1024w"></figure></p><p>Fa√Ætes-le bien pour chacune de vos configurations de Build, sinon vous aurez une exception √† l‚Äôex√©cution concernant le Keychain !</p><h3 id="surcharge-de-la-m√©thode-openurl-dans-appdelegate">Surcharge de la m√©thode OpenUrl dans AppDelegate</h3>
<pre><code class="language-csharp">using Microsoft.Identity.Client;
[...]

[Register(&quot;AppDelegate&quot;)]
public partial class AppDelegate : global::Xamarin.Forms.Platform.iOS.FormsApplicationDelegate
{
    [...]
    
    public override bool OpenUrl(UIApplication app, NSUrl url, NSDictionary options)
    {
        AuthenticationContinuationHelper.SetAuthenticationContinuationEventArgs(url);
        return base.OpenUrl(app, url, options);
    }
}
</code></pre>
<h2 id="configuration-lapplication-android">Configuration l‚Äôapplication Android</h2>
<h3 id="manifeste">Manifeste</h3>
<p>Comme pour iOS, le <em>Redirect Uri</em> doit √™tre d√©clar√© dans le manifeste Android.</p><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:versionCode=&quot;1&quot; android:versionName=&quot;1.0&quot; package=&quot;com.companyname.adb2capp&quot;&gt;
    &lt;uses-sdk android:minSdkVersion=&quot;21&quot; android:targetSdkVersion=&quot;30&quot; /&gt;
    &lt;application android:label=&quot;ADB2CApp.Android&quot; android:theme=&quot;@style/MainTheme&quot;&gt;
        
        &lt;!-- MSAL REGISTRATION START --&gt;
        &lt;activity android:name=&quot;microsoft.identity.client.BrowserTabActivity&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.VIEW&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot; /&gt;
                &lt;data android:scheme=&quot;msal[redirect_uri]&quot; android:host=&quot;auth&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;!-- MSAL REGISTRATION END --&gt;
    &lt;/application&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;
&lt;/manifest&gt;
</code></pre>
<h3 id="modifications-dans-mainactivity">Modifications dans <em>MainActivity</em></h3>
<p>L‚Äôauthentification MSAL n√©cessite :</p><ul>
<li>De passer l‚Äôactivity √† <em>App.UIParent</em></li>
<li>De surcharger <em>OnActivityResult</em></li>
</ul>
<pre><code class="language-csharp">using Microsoft.Identity.Client;
[...]

public class MainActivity : FormsAppCompatActivity
{
    protected override void OnCreate(Bundle bundle)
    {
        TabLayoutResource = Resource.Layout.Tabbar;
        ToolbarResource = Resource.Layout.Toolbar;

        base.OnCreate(bundle);

        Xamarin.Essentials.Platform.Init(this, savedInstanceState);
        global::Xamarin.Forms.Forms.Init(this, savedInstanceState);
        LoadApplication(new App());
        // ADDED
        App.UIParent = this;
    }

    // OVERRIDED
    protected override void OnActivityResult(int requestCode, Result resultCode, Intent data)
    {
        base.OnActivityResult(requestCode, resultCode, data);
        AuthenticationContinuationHelper.SetAuthenticationContinuationEventArgs(requestCode, resultCode, data);
    }
    
    [...]
}
</code></pre>
<h2 id="impl√©mentation-dans-le-projet-xamarinforms">Impl√©mentation dans le projet Xamarin.Forms</h2>
<h3 id="cr√©ation-dune-page-de-login">Cr√©ation d‚Äôune page de Login</h3>
<p>On va faire super simple, cr√©ez une page <code>LoginPage.xaml</code>, ajoutez-y un bouton <code>Login</code> et abonnez-le √† l‚Äô√©v√©nement <code>Clicked</code>.</p><pre><code class="language-xml">&lt;ContentPage.Content&gt;
    &lt;Button x:Name=&quot;LoginButton&quot;
        Text=&quot;LOGIN&quot;
        Clicked=&quot;LoginButton_Clicked&quot;
        VerticalOptions=&quot;Center&quot;
        HorizontalOptions=&quot;Center&quot;
        /&gt;
&lt;/ContentPage.Content&gt;
</code></pre>
<p>Visuellement, difficile de faire plus basique :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/c2336499611b40d4a380610ef52dabe7.png" alt="Login Page"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/c2336499611b40d4a380610ef52dabe7-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/c2336499611b40d4a380610ef52dabe7-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/c2336499611b40d4a380610ef52dabe7-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/c2336499611b40d4a380610ef52dabe7-lg.png 1024w"></figure></p><p>A l‚Äôapparition de la page, appelez <code>AcquireTokenSilentAsync</code> pour rafra√Æchir le token d‚Äôauthentification, au cas o√π un utilisateur soit d√©j√† authentifi√©.</p><pre><code class="language-csharp">public partial class LoginPage : ContentPage
{
    [...]

    protected override async void OnAppearing()
    {
        try
        {
            // Look for existing account
            IEnumerable&lt;IAccount&gt; accounts = await App.AuthenticationClient.GetAccountsAsync();
            
            AuthenticationResult result = await App.AuthenticationClient
                .AcquireTokenSilent(Constants.Scopes, accounts.FirstOrDefault())
                .ExecuteAsync();
                
            await Navigation.PushAsync(new LogoutPage(result));
        }
        catch
        {
            // Do nothing - the user isn&#39;t logged in
        }
        base.OnAppearing();
    }

    [...]
}
</code></pre>
<p>Au clic sur le bouton, <code>AcquireTokenInteractive</code> est utilis√© pour ouvrir le navigateur de l‚Äôappareil et afficher la page de Signin.</p><ul>
<li>Si la connexion r√©ussit le r√©sultat de l‚Äôauthentification est pass√© √† la page <code>LogoutPage</code>.</li>
<li>Si l‚Äôutilisateur clique sur l‚Äôoption ‚Äúj‚Äôai oubli√© mon mot de passe‚Äù, une exception particuli√®re est intercept√©e pour lancer la proc√©dure de r√©cup√©ration de mot de passe.</li>
</ul>
<pre><code class="language-csharp">private async void LoginButton_Clicked(object sender, EventArgs e)
{
    AuthenticationResult result;
    try
    {
        result = await App.AuthenticationClient
            .AcquireTokenInteractive(Constants.Scopes)
            .WithPrompt(Prompt.SelectAccount)
            .WithParentActivityOrWindow(App.UIParent)
            .ExecuteAsync();

        await Navigation.PushAsync(new LogoutPage(result));
    }
    catch (MsalException ex)
    {
        if (ex.Message != null &amp;&amp; ex.Message.Contains(&quot;AADB2C90118&quot;))
        {
            result = await OnForgotPassword();
            await Navigation.PushAsync(new LogoutPage(result));
        }
        else if (ex.ErrorCode != &quot;authentication_canceled&quot;)
        {
            await DisplayAlert(&quot;An error has occurred&quot;, &quot;Exception message: &quot; + ex.Message, &quot;Dismiss&quot;);
        }
    }
}
</code></pre>
<p>Et voici le code pour la r√©initialisation du mot de passe :</p><pre><code class="language-csharp">private async Task&lt;AuthenticationResult&gt; OnForgotPassword()
{
    try
    {
        return await App.AuthenticationClient
            .AcquireTokenInteractive(Constants.Scopes)
            .WithPrompt(Prompt.SelectAccount)
            .WithParentActivityOrWindow(App.UIParent)
            .WithB2CAuthority(Constants.AuthorityPasswordReset)
            .ExecuteAsync();
    }
    catch (MsalException)
    {
        // Do nothing - ErrorCode will be displayed in OnLoginButtonClicked
        return null;
    }
}
</code></pre>
<p>Une fois la page cr√©√©e, remplacez <code>MainPage</code> dans <code>App</code> par une <code>NavigationPage</code> : <code>MainPage = new NavigationPage(new LoginPage());</code> de fa√ßon √† naviguer directement sur la <code>LoginPage</code> √† l‚Äôouverture de l‚Äôapplication.</p><h3 id="cr√©ation-dune-page-de-logout">Cr√©ation d‚Äôune page de logout</h3>
<p>La page <code>LogoutPage</code> est tr√®s similaire √† la page de login √† ceci pr√®s :</p><ul>
<li>Son constructeur re√ßoit en param√®tre le r√©sultat de l‚Äôauthentification</li>
<li>Un <code>Label</code> affiche les informations de base de l‚Äôutilisateur</li>
<li>Le bouton <code>Login</code> est remplac√© par un bouton <code>Logout</code></li>
</ul>
<pre><code class="language-xml">&lt;ContentPage.Content&gt;
    &lt;StackLayout VerticalOptions=&quot;Center&quot; HorizontalOptions=&quot;Center&quot;&gt;
        &lt;Label x:Name=&quot;UserInfoLabel&quot;
                   FontSize=&quot;Large&quot;
                   HorizontalTextAlignment=&quot;Center&quot;
                   /&gt;
        &lt;Button x:Name=&quot;LogoutButton&quot;
                    Text=&quot;LOGOUT&quot;
                    Clicked=&quot;LogoutButton_Clicked&quot;
                    HorizontalOptions=&quot;Center&quot;
                    VerticalOptions=&quot;Center&quot;
                    /&gt;
    &lt;/StackLayout&gt;
&lt;/ContentPage.Content&gt;
</code></pre>
<p>Commen√ßons par r√©cup√©rer l‚Äô<code>AuthenticationResult</code> dans le constructeur de la page :</p><pre><code class="language-csharp">AuthenticationResult authenticationResult;
public LogoutPage(AuthenticationResult result)
{
    InitializeComponent();	
    authenticationResult = result;
}
</code></pre>
<h4 id="les-informations-utilisateur-claims">Les informations utilisateur (Claims)</h4>
<p>Les informations concernant l‚Äôutilisateur, celles que vous avez s√©lectionn√©es parmi les <code>Claims</code> lors de la cr√©ation de votre <code>User Flow Signin</code> sont cod√©es dans la propri√©t√© <code>authenticationResult.IdToken</code> sous la forme d‚Äôun <strong><a href="https://fr.wikipedia.org/wiki/JSON_Web_Token">token jwt</a>.</strong>
Pour le d√©coder, vous aurez besoin d‚Äôinstaller le package nuget <code>System.IdentityModel.Tokens.Jwt</code>.
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/bab1879b2fd647caabcab68ccfaa7a27.png" alt="Package nuget JWT"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/bab1879b2fd647caabcab68ccfaa7a27-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bab1879b2fd647caabcab68ccfaa7a27-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bab1879b2fd647caabcab68ccfaa7a27-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/bab1879b2fd647caabcab68ccfaa7a27-lg.png 1024w"></figure></p><p>Et voici le snippet pour le d√©coder :</p><pre><code class="language-csharp">var stream = authenticationResult.IdToken;
var handler = new JwtSecurityTokenHandler();
JwtSecurityToken decodedToken = (JwtSecurityToken)handler.ReadToken(stream);
</code></pre>
<p>Vous retrouverez toutes les informations dans une collection d‚Äôobjet <code>Claim</code>, notamment au travers les propri√©t√©s <code>Type</code> et <code>Value</code> :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/85c24b29abca478a83d2c41aa5f504b3.png" alt="Structure des donn√©es de Claim"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/85c24b29abca478a83d2c41aa5f504b3-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/85c24b29abca478a83d2c41aa5f504b3-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/85c24b29abca478a83d2c41aa5f504b3-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/85c24b29abca478a83d2c41aa5f504b3-lg.png 1024w"></figure></p><p>Exemple, pour afficher le nom et la ville de l‚Äôutilisateur :</p><pre><code class="language-csharp">string name = decodedToken.Claims.FirstOrDefault(c =&gt; c.Type == &quot;name&quot;)?.Value ?? &quot;Noname&quot;;
string city = decodedToken.Claims.FirstOrDefault(c =&gt; c.Type == &quot;city&quot;)?.Value ?? &quot;Unknown city&quot;;

UserInfoLabel.Text = $&quot;Welcome {name}, from {city}&quot;;
</code></pre>
<p>Le code sera appel√© de pr√©f√©rence dans le <code>OnAppearing</code> de la page plut√¥t que dans son constructeur.</p><p>Et voil√† le r√©sultat :
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/1050e4916bdf4788b637930fa9fad470.png" alt="Page de Logout"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/1050e4916bdf4788b637930fa9fad470-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1050e4916bdf4788b637930fa9fad470-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1050e4916bdf4788b637930fa9fad470-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/1050e4916bdf4788b637930fa9fad470-lg.png 1024w"></figure></p><h3 id="d√©connexion">D√©connexion</h3>
<p>La d√©connexion consiste principalement √† retirer un compte de <code>AuthenticationClient</code> :</p><pre><code class="language-csharp">private async void LogoutButton_Clicked(object sender, EventArgs e)
{
    IEnumerable&lt;IAccount&gt; accounts = await App.AuthenticationClient.GetAccountsAsync();
    while (accounts.Any())
    {
        await App.AuthenticationClient.RemoveAsync(accounts.First());
        accounts = await App.AuthenticationClient.GetAccountsAsync();
    }
    
    await Navigation.PopAsync();
}
</code></pre>
<h3 id="la-page-de-signin">La page de Signin</h3>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/cd085170ebd9443da4c69f613d06d631.png" alt="Page de Signin"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/cd085170ebd9443da4c69f613d06d631-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cd085170ebd9443da4c69f613d06d631-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cd085170ebd9443da4c69f613d06d631-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/cd085170ebd9443da4c69f613d06d631-lg.png 1024w"></figure><h3 id="page-de-r√©initialisation-de-mot-de-passe">Page de r√©initialisation de mot de passe</h3>
<figure class="post__image"><img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/42/ff9ca60e682d4f16acd619ee2d0aa7c6.png" alt="Page de r√©initialisation de mot de passe"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff9ca60e682d4f16acd619ee2d0aa7c6-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff9ca60e682d4f16acd619ee2d0aa7c6-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff9ca60e682d4f16acd619ee2d0aa7c6-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/42/responsive/ff9ca60e682d4f16acd619ee2d0aa7c6-lg.png 1024w"></figure>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Le Xamarin Community Toolkit</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/le-xamarin-community-toolkit/"/>
        <id>https://www.sylvainmoingeon.fr/le-xamarin-community-toolkit/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/41/whatsnewintoolkit.png" medium="image" />
            <category term="toolkit"/>
            <category term="Xamarin.Forms"/>

        <updated>2021-01-27T17:58:25+01:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/41/whatsnewintoolkit.png" alt="" />
                    
  <p>
    Fruit de la collaboration entre l'√©quipe Xamarin et la communaut√© Open Source, le <a href="https://github.com/xamarin/XamarinCommunityToolkit" target="_blank">Xamarin Community Toolkit</a> est √† <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> ce que le sabre laser est au Jedi, c'est-√†-dire son indispensable compl√©ment.
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/41/communitytoolkit.png" height="142" width="300" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-lg.png 1024w">
      
    </figure>

  <p>
    Si j'en parle aujourd'hui, c'est parce que le toolkit est d√©sormais disponible dans sa version stable mais aussi parce que c'est lui qui recevra toutes les nouveaut√©s concernant Xamarin.Forms, cette plateforme n'√©tant plus vou√©e √† √©voluer apr√®s la version 5.0 et jusqu'√† son absorption par <a href="https://devblogs.microsoft.com/dotnet/introducing-net-multi-platform-app-ui/" target="_blank">dotNet MAUI</a>. Mais voyons cela plus en d√©tails.
  </p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/41/whatsnewintoolkit.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    Fruit de la collaboration entre l'√©quipe Xamarin et la communaut√© Open Source, le <a href="https://github.com/xamarin/XamarinCommunityToolkit" target="_blank">Xamarin Community Toolkit</a> est √† <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> ce que le sabre laser est au Jedi, c'est-√†-dire son indispensable compl√©ment.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/41/communitytoolkit.png" height="142" width="300" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/41/responsive/communitytoolkit-lg.png 1024w">
      
    </figure>

  <p>
    Si j'en parle aujourd'hui, c'est parce que le toolkit est d√©sormais disponible dans sa version stable mais aussi parce que c'est lui qui recevra toutes les nouveaut√©s concernant Xamarin.Forms, cette plateforme n'√©tant plus vou√©e √† √©voluer apr√®s la version 5.0 et jusqu'√† son absorption par <a href="https://devblogs.microsoft.com/dotnet/introducing-net-multi-platform-app-ui/" target="_blank">dotNet MAUI</a>. Mais voyons cela plus en d√©tails.
  </p>


    <h2 id="xamarinforms-50">
      Xamarin.Forms 5.0
    </h2>

  <p>
    <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> est depuis peu disponible dans sa derni√®re version, et quand je dis derni√®re, c'est r√©ellement la derni√®re. Ensuite, il n'y en aura plus ! Mais n'ayez crainte, il ne s'agit pas d'une disparition mais d'une mutation vers <a href="https://devblogs.microsoft.com/dotnet/introducing-net-multi-platform-app-ui/" target="_blank">Microsoft MAUI</a>.
  </p>

  <p>
    Toujours est-il que dans un soucis de qualit√©, l'√©quipe Xamarin a d√©cid√© que cette derni√®re mouture serait avant tout ax√©e sur la stabilit√© et l'am√©lioration des performances. Le choix a donc √©t√© fait de d√©placer dans le Community Toolkit les fonctionnalit√©s de Xamarin.Forms qui √©taient rest√©e au stade exp√©rimental (comme les contr√¥les <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/views/expander" target="_blank">Expander</a> ou <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/views/mediaelement" target="_blank">MediaElement</a> par exemple) ou dont le d√©veloppement n'√©tait pas termin√©.
  </p>

  <p>
    C'est donc au <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/" target="_blank">Community Toolkit</a> que revient la charge de toutes les nouveaut√©s de Xamarin.Forms !
  </p>

  <p class="msg msg--highlight">
    Vous comprenez donc bien que pour b√©n√©ficier des prochaines √©volutions de Xamarin.Forms, il faudra vous tourner vers le toolkit !
  </p>

  <p>
    Mais ce fameux toolkit, que contient-il donc ?
  </p>

    <h2 id="le-xamarin-community-toolkit">
      Le Xamarin Community Toolkit
    </h2>

  <p>
    Je ne vais pas vous donner une liste exhaustive du contenu du toolkit, d'abord parce que tout est disponible dans <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/" target="_blank">sa documentation</a> et surtout il va continuer d'√©voluer apr√®s l'√©criture de cet article. Mais voici ce que vous y trouverez dans les grandes lignes.
  </p>

    <h3 id="behaviors">
      Behaviors
    </h3>

  <p>
    Fonctionnalit√© peu connue (ou en tout cas trop peu utilis√©e) de Xamarin.Forms, les <code>Behaviors</code> sont des bouts de code r√©utilisables qui ajoutent des comportements √† vos composants XAML. Leur puissance est d'√™tre modulable et de permettre d'ajouter ou de modifier des comportements √† des contr√¥les XAML sans en modifier le code ni en cr√©er de nouveaux.
  </p>

  <p>
    Par exemple, vous trouverez dans le toolkit un <code>EmailValidationBehavior</code> qui, vous l'aurez compris, ajoute un comportement de validation d'email √† vos champs de saisie.
  </p>

  <p>
    Dans un autre registre, il y a le toujours tr√®s utile&nbsp;<code>EventToCommandBehavior</code> qui permet d'ex√©cuter une commande de votre ViewModel √† partir du d√©clenchement d'un √©v√©nement du contr√¥le.
  </p>

  <p>
    Bref, les <code>Behaviors</code> sont puissants et tr√®s diversifi√©s, vous en trouverez une grosse douzaine dans le toolkit !
  </p>

    <h3 id="converters">
      Converters
    </h3>

  <p>
    Les <code>Converters</code> deviennent vite indispensables quand on souhaite suivre proprement l'architecture MVVM. Ils √©vitent bien des bidouilles inutiles dans vos ViewModels (genre cr√©er artificiellement une propri√©t√© qui inverse la valeur bool√©enne d'une autre, vous voyez ce que je veux dire, hein, inutile de nier !).
  </p>

  <p>
    Le plus connu de tous est sans doute le <code>Converter</code> d'inversion de bool√©en : vous avez une propri√©t√© <code>IsBusy</code> dans votre ViewModel et vous voulez rendre un contr√¥le visible quand sa valeur est <code>false</code>. Vous devez donc lier la propri√©t√© <code>IsVisible</code> avec l'inverse de <code>IsBusy</code> ! Vous avez le choix entre <a href="https://www.sylvainmoingeon.fr/developpez-des-applications-sans-crotte-de-nez/">faire le cradingue</a> et ajouter une nouvelle propri√©t√© <code>IsNotBusy</code> dans votre code (non mais quelle horreur) ou faire cela proprement avec un Converter.
  </p>

  <p>
    C'est une vingtaine de <code>Converters</code> tr√®s utiles qui vous attendent dans le toolkit.
  </p>

    <h3 id="des-tas-de-views-contrles-xaml">
      Des tas de Views (contr√¥les XAML)
    </h3>

  <p>
    AvatarView, BadgeView, CameraView, Expander, MediaElement... une douzaine de contr√¥les XAML pr√™ts √† l'emploi qui vous √©viteront d'installer de multiples librairies tierces pas toujours maintenus dans le temps et finissent souvent par poser des probl√®mes de compatibilit√©. Ici, pas de soucis, c'est maintenu main dans la main par l'√©quipe Xamarin et la communaut√©.
  </p>

    <h3 id="et-dautres-choses-encore">
      Et d'autres choses encore
    </h3>

  <p>
    Des helpers MVVM, des <code>Effects</code> XAML (cousin des <code>Behaviors</code> mais plus light), des extensions, pour en savoir plus, je vous invite √† consulter <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/" target="_blank">la documentation</a> et les quelques ressources que je donne juste apr√®s, l√†, maintenant.
  </p>

    <h2 id="ressources">
      Ressources
    </h2>

  <p>
    J'ai d√©j√† donn√© le lien plusieurs fois mais si vous l'avez manqu√©, dirigez-vous vers la <a href="https://docs.microsoft.com/fr-fr/xamarin/community-toolkit/" target="_blank">documentation officielle du Xamarin Community Toolkit</a>.
  </p>

  <p>
    Le d√©p√¥t GitHub :&nbsp;<a href="https://github.com/xamarin/XamarinCommunityToolkit" target="_blank">https://github.com/xamarin/XamarinCommunityToolkit</a>
  </p>

  <p>
    Le d√©p√¥t de l'application d'exemples :&nbsp;<a href="https://github.com/xamarin/XamarinCommunityToolkit/tree/main/samples" target="_blank">https://github.com/xamarin/XamarinCommunityToolkit/tree/main/samples</a>
  </p>

  <p>
    L'article de blog de Gerald Versluis :&nbsp;<a href="https://devblogs.microsoft.com/xamarin/xamarin-community-toolkit/" target="_blank">Xamarin Community Toolkit: A Must-Have Xamarin Library</a>
  </p>

  <p>
    Les vid√©os de pr√©sentation par deux stars du monde Xamarin (Gerald Versluis et Javier Suarez)
  </p>

  <p>
    <div class="post__iframe"><iframe loading="lazy" width="560" height="315" src="https://www.youtube-nocookie.com/embed/l09fzU0_N04" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><br>
  </p>

  <p>
    <div class="post__iframe"><iframe loading="lazy" width="560" height="315" src="https://www.youtube-nocookie.com/embed/JmZbfr1590A" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Planet Xamarin</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/planet-xamarin/"/>
        <id>https://www.sylvainmoingeon.fr/planet-xamarin/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/40/planetxamarin-featured-badge.png" medium="image" />

        <updated>2021-01-26T17:53:14+01:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/40/planetxamarin-featured-badge.png" alt="Logo Planet Xamarin" />
                    Chercher des ressources concernant Xamarin.Forms est parfois un parcours du combattant. C'est&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/40/planetxamarin-featured-badge.png" class="type:primaryImage" alt="Logo Planet Xamarin" /></p>
                
  <p>
    Chercher des ressources concernant Xamarin.Forms est parfois un parcours du combattant. C'est tout √©parpill√©, il y a du bon, du moins bon, des choses pas franchement √† jour.
  </p>

  <p>
    Et s'il existait un pays merveilleux dans lequel les meilleurs blogs √©taient r√©unis ?
  </p>

  <p>
    Ce pays, ou plut√¥t cette plan√®te, existe et s'appelle <a href="https://www.planetxamarin.com/" target="_blank">Planet Xamarin</a> !
  </p>

  <p>
    Il s'agit d'un agr√©gateur de blog, s'y abonner, c'est <a href="https://www.planetxamarin.com/feed" target="_blank">s'abonner au gratin international des blogs Xamarin</a> !
  </p>

  <p>
    Bon, c'est vrai, j'en fais des caisses, mais c'est aussi parce que depuis peu je fais partie de cette joyeuse communaut√©. Mon blog est d√©sormais "Featured by Planet Xamarin".
  </p>

    <figure class="post__image post__image--center">
      <a href="https://www.planetxamarin.com/" target="_blank">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/40/planetxamarin-featured-badge-2.png" height="180" width="430" alt="Logo de Planet Xamarin"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/40/responsive/planetxamarin-featured-badge-2-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/40/responsive/planetxamarin-featured-badge-2-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/40/responsive/planetxamarin-featured-badge-2-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/40/responsive/planetxamarin-featured-badge-2-lg.png 1024w">
      </a>
      
    </figure>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Utiliser des images vectorielles SVG dans Xamarin.Forms</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/utiliser-des-images-vectorielles-svg-dans-xamarinforms/"/>
        <id>https://www.sylvainmoingeon.fr/utiliser-des-images-vectorielles-svg-dans-xamarinforms/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/39/cover_svg.png" medium="image" />
            <category term="svg"/>
            <category term="Xamarin.Forms"/>
            <category term="XAML"/>

        <updated>2020-11-17T15:55:28+01:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/39/cover_svg.png" alt="" />
                    Il est possible de longue date d'utiliser des biblioth√®ques tierces telles que&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/39/cover_svg.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    Il est possible de longue date d'utiliser des biblioth√®ques tierces telles que <a href="https://github.com/mono/SkiaSharp" target="_blank">Skiasharp</a> pour afficher des images vectorielles dans <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a>.&nbsp;Mais quand on est soucieux de la l√©g√®ret√© et des performances de son application, il est souvent pr√©f√©rable de se limiter aux fonctionnalit√©s propos√©es par d√©faut par notre plateforme de d√©veloppement.
  </p>

  <p>
    Depuis l'apparition des <code>Path</code> avec la version 4.8, Xamarin.Forms est en mesure d'utiliser d'afficher des images vectorielles sans l'aide d'aucun autre package !
  </p>

  <p>
    Je vous montre comment √ßa se path... euh... passe ?
  </p>
<hr class="separator separator--dots" />

    <h2 id="convertir-le-contenu-dun-svg-en-path">
      Convertir le contenu d'un SVG en Path
    </h2>

  <p class="msg msg--info">
    Les fonctionnalit√©s utilis√©es dans cet article n√©cessitent Xamarin.Forms 5.0 ou au minimum Xamarin.Forms 4.8 avec le flag exp√©rimental :&nbsp;<code>Device.SetFlags(new string[] { "Shapes_Experimental" });</code> dans le constructeur de la classe <code>App</code>
  </p>

  <p>
    Alors oui, je vous ai un tout petit peu menti. On ne peut toujours pas incorporer un fichier svg et l'utiliser comme ressource. Mais un fichier svg n'√©tant que du texte balis√© en XML, il est tr√®s facile d'en extraire le contenu et d'en faire une forme dans Xamarin.Form.
  </p>

  <p>
    Nous prendrons deux exemples : un cas simple o√π l'image est constitu√©e d'un seul chemin et un cas plus complexe o√π l'image est compos√©e de plusieurs chemins.
  </p>

  <p>
    Nous verrons ensuite comment rendre une image vectorielle r√©utilisable facilement dans le code sans duplication √† l'aide des <code>Styles</code>.
  </p>

    <h3 id="image-simple-compose-dun-seul-chemin">
      Image simple compos√©e d'un seul chemin
    </h3>

  <p>
    Nous allons partir de ce svg tr√®s simple repr√©sentant un avion :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/39/airport.svg" height="64" width="64" alt="Une image vectorielle simple" >
      <figcaption>Une image vectorielle simple</figcaption>
    </figure>

  <p>
    Si vous ouvrez le fichier avec un √©diteur de texte, vous y trouverez ceci :
  </p>
<pre class="line-numbers  language-html"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;svg enable-background="new 0 0 64 64" version="1.1" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"&gt;
    &lt;path d="M15,6.8182L15,8.5l-6.5-1 l-0.3182,4.7727L11,14v1l-3.5-0.6818L4,15v-1l2.8182-1.7273L6.5,7.5L0,8.5V6.8182L6.5,4.5v-3c0,0,0-1.5,1-1.5s1,1.5,1,1.5v2.8182 L15,6.8182z"/&gt;
&lt;/svg&gt;
</code></pre>

  <p>
    Ce qui nous int√©resse ici, c'est la balise <code>path</code> et en particulier son attribut <code>d</code> contenant le trac√© du dessin. Nous allons simplement copier le contenu de <code>d</code> dans la propri√©t√© <code>Data</code> d'un <code>Path</code> Xamarin.Forms. Comme ceci :&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;Path Aspect="Uniform"
      Data="M15,6.8182L15,8.5l-6.5-1 l-0.3182,4.7727L11,14v1l-3.5-0.6818L4,15v-1l2.8182-1.7273L6.5,7.5L0,8.5V6.8182L6.5,4.5v-3c0,0,0-1.5,1-1.5s1,1.5,1,1.5v2.8182 L15,6.8182z"
      Fill="Black"
      HeightRequest="64"  /&gt;</code></pre>

  <p>
    La propri√©t√© <code>Aspect</code> avec la valeur <code>Uniform</code> conserve les proportions de l'image. La propri√©t√© <code>Fill</code> indique la couleur de remplissage de la forme.
  </p>

  <p>
    Sans entrer trop loin dans les d√©tails, il est tr√®s facile de manipuler l'image, par exemple en modifier le contour, le remplissage ou lui appliquer des transformations.
  </p>

  <p>
    La m√™me image vectorielle agrandie x2, pivot√©e de 45¬∞ avec un fond vert et un contour pointill√© noir.
  </p>
<pre class="line-numbers  language-html"><code>&lt;Path Aspect="Uniform"
      Data="M15,6.8182L15,8.5l-6.5-1 l-0.3182,4.7727L11,14v1l-3.5-0.6818L4,15v-1l2.8182-1.7273L6.5,7.5L0,8.5V6.8182L6.5,4.5v-3c0,0,0-1.5,1-1.5s1,1.5,1,1.5v2.8182 L15,6.8182z"            
      Fill="Green"
      HeightRequest="64"
      Rotation="45"
      Stroke="Black"
      Scale="2"
      StrokeDashArray="2 1"
      StrokeThickness="2" /&gt;</code></pre>

  <p>
    Le r√©sultat sous Android :<br>
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/39/screenshot-svg-simple-2.png" height="295" width="355" alt="Une image vectorielle, affich√©e et manipul√©e dans Xamarin.Forms"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-simple-2-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-simple-2-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-simple-2-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-simple-2-lg.png 1024w">
      <figcaption>Une image vectorielle, affich√©e et manipul√©e dans Xamarin.Forms</figcaption>
    </figure>

    <h3 id="image-complexe-compose-de-plusieurs-chemins">
      Image complexe compos√©e de plusieurs chemins
    </h3>

  <p>
    Malheureusement, les images vectorielles ne sont pas toujours aussi simples et sont parfois compos√©es de plusieurs chemins. Par exemple celle-ci :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/39/car.svg" height="512" width="512" alt="" >
      
    </figure>
<pre class="line-numbers  language-html"><code>&lt;?xml version="1.0"?&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"&gt;
    &lt;path d="M104,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,104,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,104,352Z"/&gt;
    &lt;path d="M408,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,408,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,408,352Z"/&gt;
    &lt;path d="M488,304V256a48.051,48.051,0,0,0-48-48H373.54l-22-58.68A43.052,43.052,0,0,0,310.7,120H160a43.044,43.044,0,0,0-40.72,28.97L90.96,208H72a48.051,48.051,0,0,0-48,48v48A16.021,16.021,0,0,0,8,320v16a16.021,16.021,0,0,0,16,16H48.58a55.994,55.994,0,0,0,110.84,0H352.58a55.994,55.994,0,0,0,110.84,0H488a16.021,16.021,0,0,0,16-16V320A16.021,16.021,0,0,0,488,304ZM356.46,208H256V160h82.46ZM40,264H56v8H40Zm8.58,72H24V320H53.41A55.5,55.5,0,0,0,48.58,336ZM104,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,104,384Zm248.58-48H159.42a55.5,55.5,0,0,0-4.83-16H357.41A55.5,55.5,0,0,0,352.58,336ZM408,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,408,384Zm40-80a7.337,7.337,0,0,0-.81.05,55.871,55.871,0,0,0-78.37-.01A7.383,7.383,0,0,0,368,304H144a7.383,7.383,0,0,0-.82.04,55.871,55.871,0,0,0-78.37.01A7.337,7.337,0,0,0,64,304H40V288H64a8,8,0,0,0,8-8V256a8,8,0,0,0-8-8H41.01A32.058,32.058,0,0,1,72,224H96a8,8,0,0,0,7.21-4.54l30.71-64a7.5,7.5,0,0,0,.37-.93A27.079,27.079,0,0,1,160,136H310.7a27.027,27.027,0,0,1,19.22,8H160a8,8,0,0,0-8,8v64a8,8,0,0,0,8,8H440a32.058,32.058,0,0,1,30.99,24H448a8,8,0,0,0-8,8v24a8,8,0,0,0,8,8h24v16ZM240,160v48H168V160ZM472,264v8H456v-8Zm16,72H463.42a55.5,55.5,0,0,0-4.83-16H488Z"/&gt;
    &lt;path d="M256,248h40a8,8,0,0,0,0-16H256a8,8,0,0,0,0,16Z"/&gt;
&lt;/svg&gt;
</code></pre>

  <p>
    Malheur ! l'image contient plusieurs chemins mais notre objet <code>Path</code> n'a qu'une seule propri√©t√© <code>Data</code> ! Comment faire ?
  </p>

  <p>
    Heureusement, la propri√©t√© <code>Data</code> de notre <code>Path</code> peut contenir bien plus qu'une simple cha√Æne de caract√®re, notamment un groupe de g√©om√©trie. Nous allons donc cr√©er un <code>GeometryGroup</code> contenant des <code>PathGeometry</code> dont nous renseigneront la propri√©t√© <code>Figures</code>.
  </p>

  <p>
    Chaque path de notre svg alimente ainsi les propri√©t√©s <code>Figures</code> de nos <code>PathGeometry</code> :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Path Aspect="Uniform"
      Fill="Black"
      HeightRequest="64"&gt;
    &lt;Path.Data&gt;
        &lt;GeometryGroup&gt;
            &lt;PathGeometry Figures="M104,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,104,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,104,352Z" /&gt;
            &lt;PathGeometry Figures="M408,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,408,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,408,352Z" /&gt;
            &lt;PathGeometry Figures="M488,304V256a48.051,48.051,0,0,0-48-48H373.54l-22-58.68A43.052,43.052,0,0,0,310.7,120H160a43.044,43.044,0,0,0-40.72,28.97L90.96,208H72a48.051,48.051,0,0,0-48,48v48A16.021,16.021,0,0,0,8,320v16a16.021,16.021,0,0,0,16,16H48.58a55.994,55.994,0,0,0,110.84,0H352.58a55.994,55.994,0,0,0,110.84,0H488a16.021,16.021,0,0,0,16-16V320A16.021,16.021,0,0,0,488,304ZM356.46,208H256V160h82.46ZM40,264H56v8H40Zm8.58,72H24V320H53.41A55.5,55.5,0,0,0,48.58,336ZM104,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,104,384Zm248.58-48H159.42a55.5,55.5,0,0,0-4.83-16H357.41A55.5,55.5,0,0,0,352.58,336ZM408,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,408,384Zm40-80a7.337,7.337,0,0,0-.81.05,55.871,55.871,0,0,0-78.37-.01A7.383,7.383,0,0,0,368,304H144a7.383,7.383,0,0,0-.82.04,55.871,55.871,0,0,0-78.37.01A7.337,7.337,0,0,0,64,304H40V288H64a8,8,0,0,0,8-8V256a8,8,0,0,0-8-8H41.01A32.058,32.058,0,0,1,72,224H96a8,8,0,0,0,7.21-4.54l30.71-64a7.5,7.5,0,0,0,.37-.93A27.079,27.079,0,0,1,160,136H310.7a27.027,27.027,0,0,1,19.22,8H160a8,8,0,0,0-8,8v64a8,8,0,0,0,8,8H440a32.058,32.058,0,0,1,30.99,24H448a8,8,0,0,0-8,8v24a8,8,0,0,0,8,8h24v16ZM240,160v48H168V160ZM472,264v8H456v-8Zm16,72H463.42a55.5,55.5,0,0,0-4.83-16H488Z" /&gt;
            &lt;PathGeometry Figures="M256,248h40a8,8,0,0,0,0-16H256a8,8,0,0,0,0,16Z" /&gt;
        &lt;/GeometryGroup&gt;
    &lt;/Path.Data&gt;
&lt;/Path&gt;
</code></pre>

  <p>
    Et hop :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/39/screenshot-svg-complexe.png" height="132" width="353" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-complexe-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-complexe-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-complexe-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-complexe-lg.png 1024w">
      
    </figure>

  <p>
    Nous voil√† capable d'afficher des images vectorielles simples ou complexes directement dans Xamarin.Forms. Mais pour l'instant, cela reste fastidieux : pour utiliser une m√™me image √† plusieurs endroits, il reste n√©cessaire de copier-coller tout le contenu du <code>Path</code> √† chaque fois.&nbsp;
  </p>

  <p id="voyons-comment-rsoudre-ce-problme-avec-style-">
    Voyons comment r√©soudre ce probl√®me avec Style !
  </p>

    <h2 id="crer-une-image-vectorielle-rutilisable-grce-aux-styles">
      Cr√©er une image vectorielle r√©utilisable gr√¢ce aux styles
    </h2>

  <p>
    Nous allons cr√©er un&nbsp;<code>ResourceDictionary</code> pour y placer des <code>Styles</code> d√©finissant le trac√© de chaque image vectorielle.<resourcedictionary <br=""></resourcedictionary>
  </p>

  <p>
    Toutes nos images SVG auront des propri√©t√©s communes, nous allons donc commencer par cr√©er un style de base :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Style x:Key="BaseSVGStyle" TargetType="Path"&gt;
    &lt;Setter Property="Aspect" Value="Uniform" /&gt;
    &lt;Setter Property="Fill" Value="Black" /&gt;
&lt;/Style&gt;</code></pre>

  <p>
    Nous allons ensuite cr√©er un style par image h√©ritant de <code>BaseSVGStyle</code>&nbsp;√† l'aide de la propri√©t√© <code>BasedOn</code>. Voici un exemple :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Style x:Key="PlaneSVG"
        BasedOn="{StaticResource BaseSVGStyle}"
        TargetType="Path"&gt;
    &lt;Setter Property="Data" Value="m430.37 48.711c29.15-29.153-11.17-67.267-39.96-38.479l-106.3 106.3-243.52-64.372-40.59 40.595 200.71 105.71-81.18 81.17-63.104-7.75-32.106 32.11 71.595 37.64 37.645 71.6 32.1-32.11-7.38-62.74 81.18-81.17 103.43 199.39 40.6-40.6-61.63-238.58 108.51-108.71z" /&gt;
    &lt;Setter Property="HeightRequest" Value="64" /&gt;
&lt;/Style&gt;
    
&lt;Style x:Key="CarSVG"
        BasedOn="{StaticResource BaseSVGStyle}"
        TargetType="Path"&gt;
    &lt;Setter Property="HeightRequest" Value="32" /&gt;
    &lt;Setter Property="Data"&gt;
        &lt;Setter.Value&gt;
            &lt;GeometryGroup&gt;
                &lt;PathGeometry Figures="M104,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,104,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,104,352Z" /&gt;
                &lt;PathGeometry Figures="M408,320a24,24,0,1,0,24,24A24.028,24.028,0,0,0,408,320Zm0,32a8,8,0,1,1,8-8A8.009,8.009,0,0,1,408,352Z" /&gt;
                &lt;PathGeometry Figures="M488,304V256a48.051,48.051,0,0,0-48-48H373.54l-22-58.68A43.052,43.052,0,0,0,310.7,120H160a43.044,43.044,0,0,0-40.72,28.97L90.96,208H72a48.051,48.051,0,0,0-48,48v48A16.021,16.021,0,0,0,8,320v16a16.021,16.021,0,0,0,16,16H48.58a55.994,55.994,0,0,0,110.84,0H352.58a55.994,55.994,0,0,0,110.84,0H488a16.021,16.021,0,0,0,16-16V320A16.021,16.021,0,0,0,488,304ZM356.46,208H256V160h82.46ZM40,264H56v8H40Zm8.58,72H24V320H53.41A55.5,55.5,0,0,0,48.58,336ZM104,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,104,384Zm248.58-48H159.42a55.5,55.5,0,0,0-4.83-16H357.41A55.5,55.5,0,0,0,352.58,336ZM408,384a40,40,0,1,1,40-40A40.04,40.04,0,0,1,408,384Zm40-80a7.337,7.337,0,0,0-.81.05,55.871,55.871,0,0,0-78.37-.01A7.383,7.383,0,0,0,368,304H144a7.383,7.383,0,0,0-.82.04,55.871,55.871,0,0,0-78.37.01A7.337,7.337,0,0,0,64,304H40V288H64a8,8,0,0,0,8-8V256a8,8,0,0,0-8-8H41.01A32.058,32.058,0,0,1,72,224H96a8,8,0,0,0,7.21-4.54l30.71-64a7.5,7.5,0,0,0,.37-.93A27.079,27.079,0,0,1,160,136H310.7a27.027,27.027,0,0,1,19.22,8H160a8,8,0,0,0-8,8v64a8,8,0,0,0,8,8H440a32.058,32.058,0,0,1,30.99,24H448a8,8,0,0,0-8,8v24a8,8,0,0,0,8,8h24v16ZM240,160v48H168V160ZM472,264v8H456v-8Zm16,72H463.42a55.5,55.5,0,0,0-4.83-16H488Z" /&gt;
                &lt;PathGeometry Figures="M256,248h40a8,8,0,0,0,0-16H256a8,8,0,0,0,0,16Z" /&gt;
            &lt;/GeometryGroup&gt;
        &lt;/Setter.Value&gt;
    &lt;/Setter&gt;
&lt;/Style&gt;</code></pre>

  <p>
    Les styles consistent donc principalement √† d√©finir la valeur de la propri√©t√© <code>Data</code> de nos <code>Path</code>.
  </p>

  <p>
    Pour les utiliser dans nos <code>Views</code>, nous devons d'abord d√©clarer le dictionnaire de ressource. Soit dans les ressources de la page, soit dans <code>App.xaml</code> si l'on souhaite acc√©der aux images partout dans le projet (<em>PathesStyles</em> est le nom de mon dictionnaire de ressource).
  </p>
<pre class="line-numbers  language-html"><code>&lt;ContentPage.Resources&gt;
    &lt;ResourceDictionary&gt;
        &lt;ResourceDictionary.MergedDictionaries&gt;
            &lt;pathes:PathesStyles /&gt;
        &lt;/ResourceDictionary.MergedDictionaries&gt;
    &lt;/ResourceDictionary&gt;
&lt;/ContentPage.Resources&gt;</code></pre>

  <p>
    Ensuite, dans la contenu de la page, c'est simple comme <i>Bonjour</i>&nbsp;, on applique le style souhait√© √† notre path :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Path Style="{StaticResource CarSVG}" /&gt;</code></pre>

  <p>
    Il est toujours possible, bien entendu, de surcharger les valeurs propos√©es par le style. Pour afficher l'image en rouge par exemple :&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;Path Style="{StaticResource CarSVG}" Fill="Red" /&gt;</code></pre>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/39/screenshot-svg.png" height="1250" width="608" alt="Un floril√®ge d'images vectorielles dans Xamarin.Forms"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/39/responsive/screenshot-svg-lg.png 1024w">
      <figcaption>Un floril√®ge d'images vectorielles dans Xamarin.Forms</figcaption>
    </figure>

  <p>
    Pour la d√©mo, les valeurs sont en dur dans le code, mais bien entendu toutes les propri√©t√©s sont <code>Bindables</code> pour en modifier les valeurs √† l'ex√©cution. Votre cr√©ativit√© fera le reste !
  </p>

    <h2 id="projet-github">
      Projet GitHub
    </h2>

  <p>
    Retrouvez la <a href="https://github.com/SylvainMoingeon/SVGDemo" target="_blank">d√©monstration de l'utilisation des Path Xamarin.Forms pour afficher des images vectorielles</a> dans mon d√©p√¥t GitHub.
  </p>

  <p>
    Pensez bien √† liker et partager pour que ce soit utile au plus grand nombre !
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Cr√©er un contr√¥le r√©utilisable 100% Xamarin.Forms, partie 2</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-2/"/>
        <id>https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-2/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/37/micro-assembly.jpg" medium="image" />
            <category term="Xamarin.Forms"/>
            <category term="XAML"/>
            <category term="MVVM"/>
            <category term="From scratch"/>

        <updated>2020-11-10T18:22:28+01:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/37/micro-assembly.jpg" alt="" />
                    Vous apprendrez notamment √† cr√©er des propri√©t√©s bindables (BindableProperty) et √† utiliser&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/37/micro-assembly.jpg" class="type:primaryImage" alt="" /></p>
                
  <p>
    
  </p>

  <p>
    Vous apprendrez notamment √† cr√©er des propri√©t√©s bindables (<code><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/xaml/bindable-properties" target="_blank">BindableProperty</a></code>) et √† utiliser les <code><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/data-binding/converters" target="_blank" class="" data-link-popup-id="1604422655301">Converters</a></code>.&nbsp;
  </p>

  <p>
    Si ce n'est pas d√©j√† fait, je vous invite √† d'abord consulter la <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/">premi√®re partie de cette article</a>&nbsp;dans laquelle nous avons construit les bases d'une image circulaires avec quelques options (placeholder, bordure...).
  </p>
<hr class="separator separator--dots" />

    <h2 id="mais-o-vaton-">
      Mais o√π va-t-on ?
    </h2>

  <p>
    Commen√ßons par un petit rappel, voici une d√©monstration anim√©e de l'image circulaire en situation.
  </p>

  <p class="msg msg--highlight">
    Comme je suis un gars vraiment sympa, pour le m√™me prix je vous ajoute une copie d'√©cran iOS. La base de code est 100% commune, <strong>un seul code pour g√©n√©rer deux applications natives</strong>. C'est la beaut√© de Xamarin.Forms.
  </p>

  <p>
    &nbsp;On y voit :&nbsp;
  </p>

  <ul>
    <li>Des images circulaires</li><li>Une bordure s'afficher si le contact est plac√© dans les favoris</li><li>Un indicateur de chargement tourbillonner bri√®vement sur les deux derni√®res images</li><li>Des images de substitution par d√©faut s'il n'existe pas d'image valide (image non renseign√©e, url invalide ou inaccessible...)</li>
  </ul>

  <div  class="gallery-wrapper">
    <div class="gallery" data-columns="3">
      <figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/37/gallery/demo-circleimage.gif" data-size="350x726">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/gallery/demo-circleimage.gif" height="726" width="350" alt="Screenshot anim√© sous Android" >
      </a>
      <figcaption>L'image circulaire en situation sous Android</figcaption>
    </figure><figure class="gallery__item">
      <a href="https://www.sylvainmoingeon.fr/media/posts/37/gallery/circleimage-ios-screenshot.png" data-size="1125x2436">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/gallery/circleimage-ios-screenshot-thumbnail.png" height="1663" width="768" alt="Screenshot sous iOS" >
      </a>
      <figcaption>Copie d'√©cran sous iOS</figcaption>
    </figure>
    </div>
  </div>

  <p>
    La mise-en-page est tr√®s simple, un titre, un sous-titre indiquant le nombre de favoris et une liste de contacts.
  </p>

  <p>
    Par contre, hors de question de reprendre tel quel le XAML de l'image circulaire cr√©√©e dans l'article pr√©c√©dent et de le coller comme √ßa, l'air de rien. H√© ! Oh ! On est des vrais professionnels n'est-ce pas ? Nous allons donc en faire un contr√¥le d√©coupl√© du reste du code et r√©utilisable au besoin partout dans le projet.
  </p>

    <h2 id="cration-du-contrle">
      Cr√©ation du contr√¥le
    </h2>

    <h3 id="composons">
      Composons
    </h3>

  <p>
    Souvenez-vous, dans la premi√®re partie de l'article nous avions cr√©√© une <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/">image circulaire</a> √† l'aide de la propri√©t√© <code>Clip</code> et d'une <code>EllipseGemotry</code>. Puis nous l'avions agr√©ment√©e de quelques options en y superposant d'autres contr√¥les dans une <code>Grid</code>.
  </p>

  <p>
    Nous avons donc une base avec une image circulaire simple :&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;Image Source="monimage.png" WidthRequest="128" HeightRequest="128"&gt;
    &lt;Image.Clip&gt;
        &lt;EllipseGeometry RadiusX="64"
                         RadiusY="64"
                         Center="64,64" /&gt;
    &lt;/Image.Clip&gt;
&lt;/Image&gt;</code></pre>

  <p>
    Et une image circulaire avanc√©e, compos√©e √† partir de la pr√©c√©dente :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid&gt;
    &lt;Image Source="monPlaceholder.png" WidthRequest="128" HeightRequest="128"&gt;
        &lt;Image.Clip&gt;
            &lt;EllipseGeometry RadiusX="64"
                         RadiusY="64"
                         Center="64,64" /&gt;
        &lt;/Image.Clip&gt;
    &lt;/Image&gt;

    &lt;Image Source="monimage.png" WidthRequest="128" HeightRequest="128"&gt;
        &lt;Image.Clip&gt;
            &lt;EllipseGeometry RadiusX="64"
                         RadiusY="64"
                         Center="64,64" /&gt;
        &lt;/Image.Clip&gt;
    &lt;/Image&gt;

    &lt;Ellipse Margin="0"
             HorizontalOptions="Center"
             VerticalOptions="Center"
             Stroke="Yellow"
             StrokeThickness="2"
             HeightRequest="128"
             WidthRequest="128"
             /&gt;

     &lt;ActivityIndicator IsRunning="{Binding Source={x:Reference monImage}, Path=IsLoading}"
                        VerticalOptions="Center"
                        HorizontalOptions="Center"
                        /&gt;
&lt;/Grid&gt;</code></pre>

  <p>
    Nous avons le squelette de notre contr√¥le mais quelque chose me chiffonne. Ce n'est tout de m√™me pas bien beau cette duplication de code. Et si, au lieu de copier-coller le code de l'image "clipp√©e" avec l'ellipse, on en faisait un contr√¥le d'image circulaire tout simple mais r√©utilisable ?
  </p>

  <p>
    Notre image √©tant inscrite dans un cercle, cela me g√™ne de d√©finir <code>HeightRequest</code> et <code>WidthRequest</code>. Les deux propri√©t√©s auront toujours la m√™me valeur, autant d√©finir une nouvelle propri√©t√© <code>ImageSize</code>.
  </p>

  <p>
    Quelque chose comme √ßa :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid&gt;
    &lt;local:CircleImage x:Name="monPlaceholder"
                         Source="monPlaceholder.png"
                         ImageSize="128" /&gt;
                         
    &lt;local:CircleImage x:Name="monImage"
                         Source="monImage.png"
                         ImageSize="128" /&gt;

    [...] Le reste du contr√¥le avec la bordure et l'activityIndicator
&lt;/Grid&gt;</code></pre>

  <p>
    Nous allons donc commencer par cr√©er un contr√¥le <code>CircleImage</code> qui h√©rite du contr√¥le Image de base, en y ajoutant une propri√©t√© <code>ImageSize</code> et un "clipping" circulaire.
  </p>

  <p>
    Et comme affecter des valeurs en dur √ßa n'a pas beaucoup d'int√©r√™t dans un vrai projet, nous rendrons la propri√©t√© <code>ImageSize</code> bindable de fa√ßon √† pouvoir √©crire quelque chose comme :
  </p>
<pre class="line-numbers  language-csharp"><code>&lt;local:CircleImage x:Name="monPlaceholder"
                     Source="{Binding MonImage}"
                     ImageSize="{Binding MyImageSize}" /&gt;</code></pre>

  <p>
    La propri√©t√© <code>Source</code> h√©ritant du contr√¥le Image de base, elle est d√©j√† bindable.
  </p>

  <p>
    Si ceci vous parait obscur, relisez mon article sur l'<a href="https://www.sylvainmoingeon.fr/xamarinforms-a-quoi-ca-sert-mvvm/">architecture MVVM</a> !
  </p>

    <h3 id="crer-un-nouveau-contrle">
      Cr√©er un nouveau contr√¥le
    </h3>

  <p>
    Pour faire les choses proprement, cr√©ez un dossier <i>CircleImage</i> √† la base de votre projet Xamarin.Forms et ajoutez-y un <code>ContentView</code> nomm√© CircleImage. Il n'y a pas de mal √† √™tre pragmatique sur le nommage. üòÅ
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/add-content-view.png" height="778" width="956" alt="Copie d'√©cran pour illustrer l'ajout d'un ContentView dans Xamarin.Forms"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/37/responsive/add-content-view-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/add-content-view-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/add-content-view-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/add-content-view-lg.png 1024w">
      <figcaption>Ajoutez un ContentView nomm√© CircleImage</figcaption>
    </figure>

  <p>
    Par d√©faut, votre <code>ContentView</code> est de type... <code>ContentView</code>. √áa va de soi mais je le pr√©cise pour les deux qui dorment au fond vers le radiateur.
  </p>

  <p>
    Nous pourrions ajouter notre <code>Image</code> comme contenu du <code>ContentView</code>, mais pourquoi alourdir le code et l'affichage natif en imbriquant des contr√¥les alors que nous avons uniquement besoin d'une image ? Nous allons donc remplacer le type <code>ContentView</code> par le type <code>Image</code>.
  </p>

  <p>
    Attention ! Pensez bien √† le faire √† la fois dans le XAML...<br>
  </p>
<pre class="line-numbers  language-csharp"><code>&lt;!-- Remplacer --&gt;
&lt;ContentView x:Class="CircleImageDemo.CircleImage.CircleImage"
&lt;-- Par --&gt;
&lt;Image x:Class="CircleImageDemo.CircleImage.CircleImage"</code></pre>

  <p>
    ...et dans le code-behind C# !
  </p>
<pre class="line-numbers  language-csharp"><code>// Remplacer
public partial class CircleImage : ContentView { }
// Par
public partial class CircleImage : Image { }</code></pre>

  <p>
    Nous avons presque tout ce qu'il nous faut, il s'agit juste de cr√©er le d√©coupage circulaire dans le XAML et d'ajouter la propri√©t√© bindable&nbsp;<code>ImageSize</code>. Commen√ßons par ceci.
  </p>

    <h3 id="exposer-des-proprits-bindables-depuis-lextrieur">
      Exposer des propri√©t√©s bindables depuis l'ext√©rieur
    </h3>

  <p>
    Je suis en train de cr√©er un contr√¥le visuel et je souhaite exposer une propri√©t√© qui soit bindable depuis et/ou vers l'ext√©rieur.&nbsp;Il s'agit principalement de d√©finir une propri√©t√© qui encapsule une <code>BindableProperty</code> au lieu d'un champs priv√© comme cela se fait habituellement.
  </p>

  <p>
    Je vous vois froncer les sourcils, alors un exemple :&nbsp;
  </p>
<pre class="line-numbers  language-csharp"><code>#region ImageSize Bindable property
// Bindable property
public static readonly BindableProperty ImageSizeProperty =
  BindableProperty.Create(
     propertyName: nameof(ImageSize),
     declaringType: typeof(CircleImage),
     returnType: typeof(double),
     defaultValue: 0.0,
     defaultBindingMode: BindingMode.OneWay,
     propertyChanged: (bindable, oldValue, newValue) =&gt;
     { });

// Gets or sets value of this BindableProperty
public double ImageSize
{
    get =&gt; (double)GetValue(ImageSizeProperty);
    set =&gt; SetValue(ImageSizeProperty, value);
}
#endregion
</code></pre>

  <p>
    Nous avons la propri√©t√© <code>ImageSize</code> qui sera expos√©e et sur laquelle on viendra "binder" dans le XAML.
  </p>

  <p>
    La gestion du binding proprement dit est laiss√©e √† la <code>BindableProperty</code> <code>ImageSizeProperty</code>&nbsp;instanci√©e par la m√©thode statique&nbsp; <code>BindableProperty.Create</code> avec les arguments suivants :&nbsp;
  </p>

  <ul>
    <li><b>propertyName</b> : nom de la propri√©t√© expos√©e, celle qui recevra les valeurs via Binding</li><li><b>declaringType</b> : type de la classe portant la propri√©t√©, ici CircleImage</li><li><b>returnType</b> : type retourn√© par la propri√©t√©</li><li>defaultValue : valeur par d√©faut</li><li>defaultBindingMode : d√©finit le sens du binding par d√©faut</li><li>coerceValue : permet de r√©√©valuer la valeur d'une BindableProperty quand la valeur d'une autre BindableProperty change. Pas √©vident de l'expliquer en une seule phrase, je vous recommande de <a href="https://docs.microsoft.com/fr-fr/xamarin/xamarin-forms/xaml/bindable-properties#coerce-value-callbacks" target="_blank">lire la documentation</a> !</li><li>propertyChanged : callback appel√© quand la valeur du binding vient de changer</li><li>propertyChanging : idem quand la valeur est en train de changer</li><li>defaultValueCreator : permet de d√©finir une valeur par d√©faut √† partir d'une <code>Func</code>&nbsp;<br></li>
  </ul>

  <p>
    Seuls les trois premiers arguments sont obligatoires.
  </p>

  <p>
    Tout ceci se place bien entendu dans le code-behind de la <code>View</code>.
  </p>

  <p>
    Nous avons d√©sormais une propri√©t√© <code>ImageSize</code> mais comment allons-nous l'utiliser en interne dans notre <code>CircleImage</code> ?
  </p>

  <p>
    Il y a plusieurs fa√ßons de voir les choses. Dans des cas simples qui touchent directement l'aspect visuel, on peut le faire directement dans le XAML. Parfois, c'est plus pertinent d'agir via les callbacks&nbsp;<code>propertyChanged</code> ou&nbsp;<code>propertyChanging</code> de la BindableProperty qui offrent plus de souplesse et de libert√© que XAML.
  </p>

  <p>
    Je vais vous pr√©senter les deux mais, bien entendu, dans le <a href="https://github.com/SylvainMoingeon/CircleImageDemo" target="_blank">projet GitHub</a> je n'ai pu en laisser qu'un !
  </p>

    <h3 id="lier-les-proprits-bindables-au-xaml-du-contrle">
      Lier les propri√©t√©s bindables au XAML du contr√¥le
    </h3>

  <p>
    Partons de notre <code>CircleImage</code> de base.&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;Image x:Class="CircleImageDemo.CircleImage.CircleImage"
       xmlns="http://xamarin.com/schemas/2014/forms"
       xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
       HeightRequest="128"
       WidthRequest="128"&gt;
    &lt;Image.Clip&gt;
        &lt;EllipseGeometry RadiusX="64"
                         RadiusY="64"
                         Center="64,64"
                         /&gt;
    &lt;/Image.Clip&gt;
&lt;/Image&gt;</code></pre>

  <p>
    L'enjeu est de r√©ussir √† lier la propri√©t√© <code>ImageSize</code> aux propri√©t√©s&nbsp;<code>HeightRequest</code> et&nbsp;<code>WidthRequest</code> de l'image, ainsi qu'aux&nbsp;<code>RadiusX</code>,&nbsp;<code>RadiusY</code> et <code>Center</code> de l'ellipse dont les valeurs sont la moiti√© de&nbsp;<code>ImageSize</code>.
  </p>

  <p>
    Pour cela, nous allons utiliser un Binding. Cela peut para√Ætre un peu confus, il faut suivre un peu : on va binder en interne une valeur qui provient d'un Binding externe. Une fois qu'on a compris √ßa, on a tout compris.
  </p>

  <p>
    Sauf que l√†, comme √ßa, √ßa ne fonctionnera pas. Il est n√©cessaire de pr√©ciser √† notre <code>View</code> que son contexte de binding est... elle-m√™me !
  </p>

  <p>
    Une m√©thode simple est de donner un nom √† notre contr√¥le, "this" par exemple pour mimer le mot cl√© "this" du C# et de donner "this" comme source du contexte de binding :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Image x:Name="this" BindingContext="{x:Reference this}" ...&gt;
</code></pre>

  <p>
    On peut d√©sormais binder <code>ImageSize</code> aux propri√©t√©s de l'<code>Image</code> :<br><br>
  </p>
<pre class="line-numbers  language-html"><code>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;Image x:Name="this"
       [...]
       BindingContext="{x:Reference this}"
       HeightRequest="{Binding ImageSize}"
       WidthRequest="{Binding ImageSize}"
       &gt;
    [...]
&lt;/Image&gt;</code></pre>

  <p>
    √áa y est, nous avons une image carr√©e de c√¥t√© <code>ImageSize</code>.&nbsp;
  </p>

  <p>
    Vous la voulez circulaire ? Fastoche, il suffirait de binder&nbsp;(ImageSize / 2) sur les propri√©t√©s de l'ellipse... si seulement c'√©tait possible !
  </p>

  <p>
    Il nous faut trouver un moyen de modifier la valeur du binding √† la vol√©e... √áa tombe bien, Xamarin.Forms nous propose un outil pour cela : le <code>Converter</code>.
  </p>

  <p>
    Je n'entre pas dans les d√©tails car j'ai un article en cours de r√©daction sur le sujet, sachez simplement que le principe est simple : il s'agit d'une classe impl√©mentant l'interface <code>IValueConverter</code>, dont la principale m√©thode re√ßoit une valeur en entr√©e et en retourne une autre en sortie. Exactement ce qu'il nous faut. Nous allons cr√©er un <code>DividerConverter</code> !
  </p>

  <p>
    Pour rendre le converter plus versatile, celui-ci expose une propri√©t√© <code>Divider</code> d√©finissant la quantit√© par laquelle nous souhaitons diviser. Nous aurions pu simplement diviser par deux, en dur dans le code, mais √ßa limiterait la r√©utilisation du converter.
  </p>

  <p>
    La m√©thode <code>Convert()</code> divise la valeur re√ßue de l'ext√©rieur, la m√©thode <code>ConvertBack()</code> fait l'inverse dans le cas d'un binding √† double sens (si on modifie la valeur au niveau de l'interface utilisateur, elle sera r√©percut√©e dans le code, mais bien entendue avec l'op√©ration arithm√©tique inverse !)
  </p>
<pre class="line-numbers  language-csharp"><code>public class DoubleDividerConverter : IValueConverter
{      
    public int Divider { get; set; } = 1;

    // Divise la valeur re√ßue par Divider
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is double doubleToDivide)
        {
            return doubleToDivide / Divider;
        }

        throw new ArgumentException($"{nameof(value)} should be of type double");
    }

    // Multiplie la valeur renvoy√©e par Divider
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is double doubleToMultiply)
        {
            return doubleToMultiply * Divider;
        }

        throw new ArgumentException($"{nameof(value)} should be of type double");
    }
}
</code></pre>

  <p>
    Reste √† utiliser le Converter dans le XAML :
  </p>

  <ul>
    <li>Le d√©clarer comme ressource statique dans la <code>View</code></li><li>L'ajouter aux Bindings</li><li>Pr√©ciser √† l'<code>EllipseGeometry</code> son contexte de Binding.</li>
  </ul>
<pre class="line-numbers  language-csharp"><code>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;Image x:Name="this"
         [...]
       &gt;
    &lt;Image.Resources&gt;
        &lt;ResourceDictionary&gt;
            &lt;local:DoubleDividerConverter 
                    x:Key="DoubleDividerConverter" 
                    Divider="2" /&gt;
        &lt;/ResourceDictionary&gt;
    &lt;/Image.Resources&gt;

    &lt;Image.Clip&gt;
        &lt;EllipseGeometry BindingContext="{x:Reference this}"
                         RadiusX="{Binding ImageSize, Converter={StaticResource DoubleDividerConverter}}"
                         RadiusY="{Binding ImageSize, Converter={StaticResource DoubleDividerConverter}}"
                         Center="??? Center attend un type Point, je vous laisse r√©fl√©chir quelques instants"
                         /&gt;
    &lt;/Image.Clip&gt;
&lt;/Image&gt;</code></pre>

  <p>
    C'est bon pour la forme de l'ellipse, nous venons d'en faire un cercle de rayon (Imagesize / 2).
  </p>

  <p>
    Reste √† la positionner via la propri√©t√© <code>Center</code>. Celle-ci attend une valeur de type <code>Point</code>. Nous allons l√† encore utiliser un converter. Il recevra la taille de l'image en entr√©e et retournera un point dont les coordonn√©es sont au centre de l'image.
  </p>

  <p>
    Vous trouverez tout le code dans le <a href="https://github.com/SylvainMoingeon/CircleImageDemo" target="_blank">d√©p√¥t GitHub</a>.&nbsp;
  </p>

    <h3 id="grer-la-proprit-bindable-dans-le-code-behind">
      G√©rer la propri√©t√© bindable dans le code behind
    </h3>

  <p>
    Si la beaut√© du XAML vous laisse de marbre, il est possible d'effectuer la m√™me chose directement dans le code-behind de la View.
  </p>

  <p>
    Il suffit de placer notre code dans l'√©v√©nement <code>propertyChanged</code> de la <code>BindableProperty</code>&nbsp;: nous y d√©finirons le rayon du cercle, la taille de l'image et nous appliquerons l'ellipse √† l'image apr√®s avoir cr√©√© celle-ci.
  </p>

  <p>
    Et c'est tout !
  </p>
<pre class="line-numbers  language-csharp"><code>public static readonly BindableProperty ImageSizeProperty =
  BindableProperty.Create(
     propertyName: nameof(ImageSize),
     declaringType: typeof(CircleImage),
     returnType: typeof(double),
     defaultValue: 0.0,
     defaultBindingMode: BindingMode.OneWay,
     propertyChanged: (bindable, oldValue, newValue) =&gt;
     {
         if (bindable is CircleImage circleImage && newValue is double imageSize)
         {
             double radius = imageSize / 2;
             EllipseGeometry ellipseGeometry = new EllipseGeometry()
             {
                 Center = new Point(radius, radius),
                 RadiusX = radius,
                 RadiusY = radius
             };

             circleImage.HeightRequest = imageSize;
             circleImage.WidthRequest = imageSize;
             circleImage.Clip = ellipseGeometry;
         }
     });
</code></pre>

  <p>
    Vous allez me dire, √ßa valait bien la peine de s'emb√™ter en XAML avec des converters ! Ce n'est pas compl√®tement faux. Mais pas totalement vrai.
  </p>

  <p>
    La qualit√© d'un code ne se limite pas √† sa simplicit√© mais aussi √† sa clart√©. Ici, un d√©veloppeur ne connaissant pas le code devra chercher √† l'aveuglette dans le code-behind pour comprendre comment l'image est dimensionn√©e et devient circulaire. Tant que √ßa reste simple, √ßa passe. Dans un code plus touffu, cela peut vite devenir un v√©ritable casse-t√™te !
  </p>

  <p>
    Il y a √©galement un risque accru de <a href="https://www.sylvainmoingeon.fr/developpez-des-applications-sans-crotte-de-nez/">monstre spaghetti et de crotte de nez dans le code</a>. Un d√©veloppeur d√©butant ou peu consciencieux, aura vite fait de m√©langer tout et n'importe quoi dans <code>propertyChanged</code>. Au minimum, il aurait fallu que j'extrais le code dans une m√©thode √† part. Et pour √™tre parfaitement propre, s√©parer le dimensionnement de l'image du d√©coupage circulaire dans deux m√©thodes distinctes. Et tant qu'on y est, placer la conversion entre la taille de l'image et l'ellipse dans une classe √† part pour que ce soit r√©utilisable. Une sorte de <code>Converter</code> qui cacherait son nom, en quelque sorte... Bref, le code-behind est plus simple surtout parce qu'on peut librement y coder comme un sale.
  </p>

  <p class="msg msg--highlight">
    L'avantage de la m√©thode "XAML", c'est que 100% du code concernant l'aspect visuel est au m√™me endroit, directement l√† o√π on irait le chercher spontan√©ment. Tout y est explicite, on sait d'embl√©e o√π chercher l'information. Et √ßa, en d√©bogage, √ßa n'a pas de prix !
  </p>

    <h2 id="appliquons-le-mme-principe-pour-crer-un-contrle-avanc">
      Appliquons le m√™me principe pour cr√©er un contr√¥le avanc√©
    </h2>

  <p>
    Nous avons d√©sormais une image circulaire simple et r√©utilisable. Nous allons de m√™me cr√©er une image circulaire encapsulant la pr√©c√©dente pour lui ajouter quelques options.
  </p>

  <p>
    Pour commencer, nous allons cr√©er comme pr√©c√©demment un <code>ContentView</code> que nous nommerons <code>AdvancedCircleImage</code> et qui h√©ritera de <code>Grid</code> puisque c'est le <code>Layout</code> de base de notre contr√¥le.
  </p>

  <p>
    Je vous laisse faire, c'est exactement comme tout √† l'heure, avec une <code>Grid</code> √† la place de l'<code>Image</code>.
  </p>

  <p>
    A l'int√©rieur de notre Grid, nous aurons donc :&nbsp;
  </p>

  <ul>
    <li>Deux it√©rations de notre <code>CircleImage</code>, l'une pour l'image, l'autre pour l'image de substitution</li><li>Une <code>Ellipse</code> pour la bordure</li><li>Un <code>ActivityIndicator</code> pour l'indicateur de chargement</li>
  </ul>

  <p>
    Dans le code-behind, nous d√©finirons quelques <code>BindablePropertie</code> :
  </p>

  <ul>
    <li>MainImageSource : source de l'image principale</li><li>PlaceholderImageSource : source du placeholder</li><li>ImageSize : taille de l'image</li><li>IsBorderVisible : la bordure est-elle visible ?</li><li>BorderColor : couleur de la bordure</li><li>BorderThickness : √©paisseur de la bordure</li><li>IsLoaderEnabled : l'indicateur de chargement est-il actif (si faux on ne le verra jamais, si vrai on le verra quand l'image est en train de charger)<br></li>
  </ul>

  <p>
    Nous allons appliquer la m√™me recette que pr√©c√©demment, voici une version simplifi√©e du XAML de laquelle j'ai retir√© ce qui n'est pas n√©cessaire √† la compr√©hension :
  </p>
<pre class="line-numbers  language-csharp"><code>&lt;Grid x:Name="this"&gt;
    &lt;Grid.Resources&gt;
        &lt;DoubleDividerConverter x:Key="DoubleDividerConverter" Divider="2" /&gt;
        &lt;ImageSizeToCenterConverter x:Key="ImageSizeToCenterConverter" /&gt;
        &lt;ColorToBrushConverter x:Key="ColorToBrushConverter" /&gt;
    &lt;/Grid.Resources&gt;

    &lt;local:CircleImage BindingContext="{x:Reference this}"
                       ImageSize="{Binding ImageSize}"
                       Source="{Binding PlaceholderImageSource}"/&gt;

    &lt;local:CircleImage x:Name="Image"
					 BindingContext="{x:Reference this}"
                     ImageSize="{Binding ImageSize}"
                     Source="{Binding MainImageSource}" /&gt;

    &lt;Ellipse BindingContext="{x:Reference this}"
             Stroke="{Binding BorderColor, Converter={StaticResource ColorToBrushConverter}}"
             StrokeThickness="{Binding BorderThickness}"
             HeightRequest="{Binding ImageSize}"
             WidthRequest="{Binding ImageSize}"
             IsVisible="{Binding IsBorderVisible}"/&gt;

    &lt;ActivityIndicator IsRunning="{Binding Source={x:Reference Image}, Path=IsLoading}"
                       BindingContext="{x:Reference this}"
                       IsVisible="{Binding IsLoaderEnabled}"
                       Color="{Binding BorderColor}"/&gt;
&lt;/Grid&gt;</code></pre>

  <p>
    Vous noterez juste l'apparition d'un nouveau <code>Converter</code> : notre propri√©t√© <code>BorderColor</code> transmet un type <code>Color</code> alors que la propri√©t√© <code>Stroke</code> de l'Ellipse attend une <code>Brush</code>.
  </p>

  <p>
    Pour le reste, ce n'est que du <code>Binding</code> vers les <code>BindableProperty</code> et des astuces que nous avons d√©j√† vu dans la <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/">premi√®re partie de l'article</a>.
  </p>

  <p>
    Nous avons d√©sormais une image circulaire avanc√©e parfaitement r√©utilisable dans notre projet ! Chouette !
  </p>

  <p>
    Nous en avons m√™me deux : <code>CircleImage</code> et <code>AdvancedCircleImage</code>&nbsp;!
  </p>

    <h2 id="utiliser-le-contrle-dans-le-code">
      Utiliser le contr√¥le dans le code
    </h2>

  <p>
    En r√©alit√©, vous savez d√©j√† comment utiliser votre contr√¥le personnalis√© puisque vous l'avez d√©j√† fait en incorporant <code>CircleImage</code> dans le XAML de <code>AdvancedCircleImage</code>.&nbsp;
  </p>

  <p>
    Il suffit de :
  </p>

  <ol>
    <li>D√©clarer le namespace auquel appartient votre contr√¥le dans votre <code>ContentPage</code></li><li>Utiliser le contr√¥le dans le XAML</li>
  </ol>

  <p>
    Voici un exemple tr√®s simplifi√© :
  </p>
<pre class="line-numbers  language-csharp"><code>&lt;ContentPage x:Class="CircleImageDemo.MainPage"
            xmlns:ci="clr-namespace:CircleImageDemo.CircleImage"
            [...]&gt;            
    &lt;ci:AdvancedCircleImage ImageSize="64"
                            MainImageSource="{Binding PhotoUrl}"
                            PlaceholderImageSource="{Binding PlaceholderImage}"
                            BorderColor="Yellow"
                            BorderThickness="4"
                            IsBorderVisible="{Binding IsBookmarked}"
                            IsLoaderEnabled="True" /&gt;
&lt;/ContentPage&gt;
</code></pre>

  <p>
    Dans le <a href="https://github.com/SylvainMoingeon/CircleImageDemo" target="_blank">projet de d√©monstration</a>, j'utilise l'<code>AdvancedCircleImage</code> dans une liste (en fait un <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/layouts/bindable-layouts" target="_blank">BindableLayout</a> mais ce n'est pas le sujet).
  </p>

    <h2 id="le-projet-de-dmonstration">
      Le projet de d√©monstration
    </h2>

  <p>
    Je vous redonne le lien vers le d√©p√¥t GitHub du projet :&nbsp;<a href="https://github.com/SylvainMoingeon/CircleImageDemo" target="_blank">https://github.com/SylvainMoingeon/CircleImageDemo</a>&nbsp;ainsi que la petite animation :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/demo-circleimage-2.gif" height="726" width="350" alt="" >
      
    </figure>

  <p>
    Celle-ci simule une page de contacts qui existe avant tout pour illustrer le contr√¥le personnalis√© que nous venons de cr√©er.
  </p>

  <p>
    L'<code>AdvancedCircleImage</code> est utilis√©e pour afficher les photos de contacts. Si l'image n'est pas renseign√©e ou indisponible (url invalide par exemple), le contr√¥le affiche une image de substitution par d√©faut √† la place.
  </p>

  <p>
    Au clic sur une fiche contact, celui-ci bascule de l'√©tat "mis en favori" √† l'√©tat "pas mis en favori", ce qui affiche ou non la bordure.
  </p>

  <p>
    L'indicateur de chargement est fugace mais visible dans les deux derni√®res fiches puisqu'une image est d√©finie dans chacune d'elle mais inaccessible (erreur 404 et url non joignable).
  </p>

    <h3 id="jetezy-un-il-">
      Jetez-y un ≈ìil !
    </h3>

  <p>
    C'est tout en ce qui concerne l'image circulaire, mais il y a deux ou trois petites choses dans le code qui pourraient vous int√©resser si vous n'√™tes pas familier avec XAML et <a href="https://www.sylvainmoingeon.fr/xamarinforms-a-quoi-ca-sert-mvvm/">MVVM</a>. Et si vous √™tes arriv√© jusqu'√† la fin de cet article, c'est sans doute le cas !
  </p>

    <h4 id="stringformat">
      StringFormat
    </h4>

  <p>
    Pour illustrer l'usage de <a href="https://www.sylvainmoingeon.fr/xamarinforms-a-quoi-ca-sert-mvvm/">MVVM</a>, j'ai ajout√© un <code>Label</code> qui indique le nombre de contacts en favori. Celui-ci utilise <code><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/data-binding/string-formatting" target="_blank">StringFormat</a></code> pour afficher une phrase compl√®te int√©grant la valeur obtenue via le <code>Binding</code>. <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/data-binding/string-formatting" target="_blank"><code>StringFormat</code></a> est un outil tr√®s puissant et malheureusement souvent n√©glig√© par les d√©veloppeurs. Il vous √©vitera pas mal de <a href="https://www.sylvainmoingeon.fr/developpez-des-applications-sans-crotte-de-nez/">mauvaises bidouilles et de crottes dans le code</a>.
  </p>

    <h4 id="code--xaml-spcifique--la-plateforme">
      Code / XAML sp√©cifique √† la plateforme
    </h4>

  <p>
    Il y a quelques cas √† la marge mais suffisamment fr√©quents o√π malheureusement un code 100% commun n'est plus suffisant. Cela tient surtout √† des diff√©rences fonctionnelles entre les plateformes.&nbsp;
  </p>

  <p>
    Par exemple, l'encoche et le bouton virtuel apparus sur iOS √† partir de l'iPhone X (il me semble).&nbsp;Lorsque vous d√©finissez votre mise-en-page, vous risquez fort d'obtenir quelque chose comme ceci :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/no-safe-area-2.png" height="915" width="422" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/37/responsive/no-safe-area-2-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/no-safe-area-2-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/no-safe-area-2-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/no-safe-area-2-lg.png 1024w">
      
    </figure>

  <p>
    Il existe quelques fonctionnalit√©s sp√©cifiques aux plateformes directement accessibles dans le code commun, notamment pour <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/platform/ios/" target="_blank">iOS</a> et <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/platform/android/" target="_blank">Android</a>. Ici, nous allons nous int√©resser au <code>SafeArea</code> d'iOS.
  </p>

  <p>
    Dans le XAML :
  </p>
<pre class="line-numbers  language-html"><code>&lt;ContentPage 
xmlns:ios="clr-namespace:Xamarin.Forms.PlatformConfiguration.iOSSpecific;assembly=Xamarin.Forms.Core"
ios:Page.UseSafeArea="True"
[...]&gt;
    [...]
&lt;/ContentPage&gt;</code></pre>

  <p>
    Ce qui corrigera le probl√®me en prot√©geant les zones de l'encoche et du bouton virtuel pour √©viter ces affreux chevauchements :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/safe-area.png" height="915" width="422" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/37/responsive/safe-area-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/safe-area-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/safe-area-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/safe-area-lg.png 1024w">
      
    </figure>

  <p class="msg msg--highlight">
    Fouillez dans la documentation, il y en a d'autres qui vous √©viterons prises de t√™te et tentatives de corriger ces choses l√† vous m√™me en codant dans les projets natifs.
  </p>

    <h4 id="designtimevisible">
      DesignTimeVisible
    </h4>

  <p>
    Si vous utilisez le <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/xaml/xaml-previewer/?pivots=windows" target="_blank">Previewer Xamarin.Forms</a>, vous constaterez que vos contr√¥les personnalis√©s n'apparaissent pas dedans, ce qui peut √™tre g√™nant lorsque vous √™tes en train de dessiner vos interfaces.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/designtime-not-visible.png" height="811" width="981" alt="Copie d'√©cran pr√©sentant le previewer Xamarin.Forms, le contr√¥le personnalis√© n'est pas affich√©"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-not-visible-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-not-visible-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-not-visible-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-not-visible-lg.png 1024w">
      <figcaption>L'image circulaire n'est pas affich√©e pas dans le previewer, quel malheur !</figcaption>
    </figure>

  <p>
    La plupart du temps, √ßa ne tient qu'√† une ligne de code ! Un simple attribut √† ajouter √† votre classe : <code>[DesignTimeVisible(true)]</code>
  </p>

  <p>
    Comme son nom l'indique de fa√ßon assez explicite, cet attribut indique si la classe doit √™tre trait√©e ou non par le previewer.
  </p>
<pre class="line-numbers  language-csharp"><code>[XamlCompilation(XamlCompilationOptions.Compile)]
[DesignTimeVisible(true)]
public partial class AdvancedCircleImage : Grid
{
[...]
}</code></pre>

  <p>
    Pensez bien √† l'ajouter √† chacun de vos contr√¥les personnalis√©s ! Ici au CircleImage et √† l'AdvancedCircleImage. Voici le r√©sultat, une fois l'attribut ajout√© √† chacune des classes :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/37/designtime-visible.png" height="758" width="949" alt="Illustration du previewer avec l'attribut DesignTimeVisible"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-visible-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-visible-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-visible-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/37/responsive/designtime-visible-lg.png 1024w">
      <figcaption>L'image circulaire est bien affich√©e gr√¢ce √† l'attribut DesignTimeVisible(true)</figcaption>
    </figure>

    <h2 id="conclusion">
      Conclusion
    </h2>

  <p>
    Pour allez plus loin, il faudrait totalement sortir le contr√¥le personnalis√© du projet et pourquoi pas en faire un package nugget. Peut-√™tre une id√©e pour un prochain article !
  </p>

  <p>
    Si vous avez des questions, des astuces ou m√™me des remontrances concernant le sujet, je vous invite √† laisser des commentaires. Juste l√† dessous. ‚¨á
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Xamarin.Forms 5.0 en approche !</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/xamarinforms-50-en-approche/"/>
        <id>https://www.sylvainmoingeon.fr/xamarinforms-50-en-approche/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/38/xf-last-year.png" medium="image" />
            <category term="Xamarin.Forms"/>

        <updated>2020-10-26T17:05:57+01:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/38/xf-last-year.png" alt="" />
                    Xamarin.Forms 5.0 pointe bient√¥t le bout de son nez et apporte son&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/38/xf-last-year.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    Xamarin.Forms 5.0 pointe bient√¥t le bout de son nez et apporte son lot de nouveaut√©s. Alors c'est vrai, pour la plupart il s'agit du passage en version stable de fonctionnalit√©s qui √©taient d√©j√† disponibles en version exp√©rimentale, mais c'est l'occasion d'en faire une r√©cap et de prendre conscience des avanc√©es qu'√† fait Xamarin.Forms cette derni√®re ann√©e.
  </p>
<hr class="separator separator--dots" />

  <p>
    Pas d'article fleuve pour cette fois, je me contente de vous pr√©senter quelques nouveaut√©s et de transmettre quelques liens vers les ressources qui vous donneront toutes les informations.
  </p>

  <p>
    La plupart des informations proviennent de la vid√©o que vous trouverez en fin d'article et du post <a href="https://devblogs.microsoft.com/xamarin/xamarin-forms-5-preview/" target="_blank">Xamarin.Forms 5 preview</a> de David Ortinau.
  </p>

    <h2 id="libre-ta-crativit-avec-les-brushes-shapes-et-paths">
      Lib√®re ta cr√©ativit√© avec les Brushes, Shapes et Paths
    </h2>

  <p>
    L'un des derniers point faible de Xamarin.Forms vient de sauter !
  </p>

  <p>
    Cr√©er des formes vectorielles, des d√©grad√©s ou des chemins complexes ne n√©cessitent plus aucune biblioth√®que tierce. Les √©l√©ments visuels peuvent √™tre d√©coup√©s selon n'importe quelle g√©om√©trie ouvrant la porte √† des design modernes et bien l√©ch√©s. Tout cela gr√¢ce aux <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/brushes/" target="_blank"><code>Brush</code></a>, <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/" target="_blank"><code>Shape</code></a> et <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/path" target="_blank"><code>Path</code></a>.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/38/shapes-sxs.png" height="1946" width="1873" alt="Illustration d'interface utilisateur utilisant les brushes, shapes et paths"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/38/responsive/shapes-sxs-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/shapes-sxs-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/shapes-sxs-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/shapes-sxs-lg.png 1024w">
      <figcaption>Avec les brushes, shapes et paths, cr√©er des design l√©ch√©s devient un jeu d'enfant !</figcaption>
    </figure>

    <h2 id="templating-encore-un-pas-de-plus-vers-le-vrai-xaml-de-wpf">
      Templating, encore un pas de plus vers le "vrai" XAML de WPF
    </h2>

  <p>
    Jusqu'√† maintenant, on pouvait cr√©er de nouveaux contr√¥les soit par composition de contr√¥les <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> existant soit en cr√©ant un nouveau contr√¥le de toute pi√®ce de fa√ßon native, c'est-√†-dire en codant √† partir de z√©ro une version par plateforme cibl√©e.
  </p>

  <p>
    La nouvelle version du <code>RadioButton</code> va plus loin et s'approche de ce que WPF propose puisqu'on peut&nbsp;d√©sormais en modifier compl√®tement le contenu √† l'aide du templating.
  </p>

  <p>
    √áa n'a l'air de rien dit comme √ßa, mais quand ce sera g√©n√©ralis√© √† tous les contr√¥les, ceux-ci pourront prendre n'importe quelle apparence sans toucher au code natif, sans recours √† des custom renderers et donc sans besoin de cr√©er de nouveaux contr√¥les. Cela repr√©sente donc une √©norme partie du code sp√©cifique aux plateformes qui dispara√Ætra au profit du code commun. Autant de temps de d√©veloppement, de maintenance et de correction de bug en moins ! C'est un premier (grand) pas vers le <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> 100% cross-plateforme et donc vers <a href="https://devblogs.microsoft.com/dotnet/introducing-net-multi-platform-app-ui/" target="_blank">MAUI</a>.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/38/radios-sxs.png" height="590" width="1785" alt="Illustration du templating sur un radioButton"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/38/responsive/radios-sxs-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/radios-sxs-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/radios-sxs-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/38/responsive/radios-sxs-lg.png 1024w">
      <figcaption>Templating sur un RadioButton</figcaption>
    </figure>

    <h2 id="enfin-un-carouselview-pleinement-fonctionnel-et-exploitable">
      Enfin un CarouselView pleinement fonctionnel et exploitable
    </h2>

  <p>
    D'abord int√©gr√© en tant que type de Page puis transform√© en Layout exp√©rimental, le <code>CarouselView</code> atteint enfin l'√¢ge de la maturit√© et dispose d√©sormais de tout le n√©cessaire pour en faire un vrai contr√¥le utilisable en production : support du <code>VisualStateManager</code>, <code>IndicatorView</code> (par exemple, les petits points qui indiquent sur quel item on est dans la liste), <code>PeekAreaInsets</code> pour faire empi√©ter les items pr√©c√©dents et suivants sur l'item courant...
  </p>

  <p>
    Je vous renvois √† la <a href="https://docs.microsoft.com/fr-fr/xamarin/xamarin-forms/user-interface/carouselview" target="_blank" class="" data-link-popup-id="1603725756108">documentation sur le CarouselView</a>.
  </p>
<div>  <video loading="lazy" width="446" height="654" controls="controls">
    <source src="../media/files/xf5-carousel-loop.mp4" type="video/mp4" />
  </video>
</div>

    <h2 id="a-glisse-avec-le-swipeview">
      √áa glisse avec le SwipeView
    </h2>

  <p>
    Aussi incroyable que cela puisse para√Ætre, <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a> ne proposait encore aucune solution pour int√©grer un mouvement de <code>Swipe</code> sur les items d'une liste. On trouvait bien ici ou l√† quelques impl√©mentations de ce comportement, mais rien d'officiel ou de bien stable. Au point que j'avais fini par cr√©er mon propre <a href="https://github.com/SylvainMoingeon/SwipableView" target="_blank">composant SwipableView pour Xamarin.Forms</a> !
  </p>

  <p>
    C'est d√©sormais de l'histoire ancienne, bienvenue au <code><a href="https://docs.microsoft.com/xamarin/xamarin-forms/user-interface/swipeview" target="_blank" class="">SwipeView</a></code>.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/38/favfighters.gif" height="934" width="466" alt="Illustration anim√©e du SwipeView Xamarin.Forms" >
      <figcaption>SwipeView Xamarin.Forms</figcaption>
    </figure>

    <h2 id="autres-nouveauts-et-infos-en-vrac">
      Autres nouveaut√©s et infos en vrac
    </h2>

  <p>
    Vous trouverez dans Xamarin.Forms 5.0 un nouveau <a href="https://docs.microsoft.com/xamarin/xamarin-forms/app-fundamentals/gestures/drag-and-drop" target="_blank" class="">gesture Drag and Drop</a>, principalement d√©di√© au surface duo avec ses deux √©crans. Mais bien entendu, rien ne vous emp√™che de l'utiliser au sein de vos applications.
  </p>

  <p>
    Plusieurs contr√¥les ont migr√© dans le <a href="https://github.com/xamarin/XamarinCommunityToolkit" target="_blank" class="">Xamarin Community Toolkit</a>, tels que <code>MediaElement</code> et <code>Expander</code>. Ceux-ci n'√©taient pas encore pr√™ts √† passer en version finale dans Xamarin.Forms mais l'√©quipe souhaitait les faire sortir du statut exp√©rimental. Ils sont donc disponibles dans le toolkit.
  </p>

  <p>
    Un changement de version majeure s'accompagne souvent de "breaking changes", ici&nbsp; notamment :
  </p>

  <ul>
    <li>MasterDetailPage et ses propri√©t√©s changent de nom suite aux pol√©miques r√©centes sur la connotation Ma√Ætre/Esclave. On parlera d√©sormais de <code>Flyout</code>.</li><li>C√¥t√© Apple, <code>UIWebView</code> qui √©tait d√©pr√©ci√© a √©t√© compl√®tement retir√©e</li>
  </ul>

  <p>
    <a href="https://docs.microsoft.com/fr-fr/xamarin/xamarin-forms/release-notes/5.0/5.0.0-pre3" target="_blank" class="">Le changelog complet de Xamarin.Forms 5.0</a>.
  </p>

    <h2 id="david-ortinau-et-james-montemagno-vous-prsente-tout-a-en-vido">
      David Ortinau et James Montemagno vous pr√©sente tout √ßa en vid√©o
    </h2>

  <p>
    Votre r√©compense pour √™tre all√© au bout de l'article :
  </p>
<div><div class="post__iframe"><iframe loading="lazy" src="https://channel9.msdn.com/Shows/XamarinShow/XamarinForms-5-Is-Here/player" width="960" height="540" allowFullScreen frameBorder="0" title="Xamarin.Forms 5 Is Here! - Microsoft Channel 9 Video"></iframe></div>
</div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Cr√©er un contr√¥le r√©utilisable 100% Xamarin.Forms, partie 1</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/"/>
        <id>https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/36/micro-assembly.jpg" medium="image" />
            <category term="Xamarin.Forms"/>
            <category term="XAML"/>
            <category term="From scratch"/>

        <updated>2020-10-22T12:13:26+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/36/micro-assembly.jpg" alt="" />
                    Dans cet article "from scratch" en deux parties, je vous pr√©sente une&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/36/micro-assembly.jpg" class="type:primaryImage" alt="" /></p>
                
  <p>
    Dans cet article "<a href="https://www.sylvainmoingeon.fr/tags/from-scratch/">from scratch</a>" en deux parties, je vous pr√©sente une mani√®re simple de cr√©er une image circulaire avanc√©e et r√©utilisable&nbsp;√† partir de z√©ro, sans custom renderer, ni biblioth√®que tierce.
  </p>

  <p>
    <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-1/">Partie 1</a> :
  </p>

  <ul>
    <li>Cr√©er une image circulaire √† l'aide de la propri√©t√© <code>Clip</code> et des <code>Geometry</code> r√©cemment apparues dans <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a></li><li>Afficher un indicateur d'activit√© pendant le chargement de l'image<br></li><li>Afficher une image de substitution en cas d'absence d'image ou d'url invalide en utilisant la technique de superposition dans une <code>Grid</code><br></li><li>Afficher une bordure autour de l'image √† l'aide des <code>Shape</code>, autre nouveaut√© de <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a><br></li><li>Utiliser des <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/internals/experimental-flags" target="_blank">fonctionnalit√©s exp√©rimentales</a> avec la version stable actuelle de <a href="https://www.sylvainmoingeon.fr/tags/xamarinforms/">Xamarin.Forms</a><br></li>
  </ul>

  <p>
    <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-2/">Partie 2</a> :
  </p>

  <ul>
    <li>Cr√©er un contr√¥le r√©utilisable et compatible <a href="https://www.sylvainmoingeon.fr/tags/mvvm/">MVVM</a></li><ul><li>D√©finir des propri√©t√©s bindables (<code>BindableProperty</code>)</li><li>Utiliser les <code>Converters</code></li></ul>
  </ul>

  <p>
    Les pr√©sentations sont faites, place au concret.
  </p>
<hr class="separator separator--dots" />

  <p class="msg msg--info">
    Certaines fonctionnalit√©s comme les <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/" target="_blank">Shapes</a>&nbsp;et leurs  <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/geometries" target="_blank">Geometries</a> n√©cessitent Xamarin.Forms 4.8 ou sup√©rieure, pensez bien √† mettre-√†-jour le package apr√®s avoir cr√©√© votre solution !
  </p>

    <h2 id="commenons-par-la-fin">
      Commen√ßons par la fin
    </h2>

  <p>
    Pas de suspens, je vous livre d'embl√©e un visuel pour que vous sachiez o√π je vous am√®ne. Celui-ci simule une page de contact :
  </p>

    <figure class="post__image post__image--center">
      <a href="https://github.com/SylvainMoingeon/CircleImageDemo" target="_blank">
        <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/36/demo-circleimage-3.gif" height="726" width="350" alt="D√©monstration de l'image circulaire avec ses diff√©rentes options" >
      </a>
      <figcaption>D√©monstration de l'image circulaire avec ses diff√©rentes options</figcaption>
    </figure>

  <p>
    Niveau contenu, la page affiche une liste de contacts dont chaque photo provient d'une source diff√©rente :
  </p>

  <ol>
    <li>Une photo charg√©e √† partir d'une url</li><li>Une photo ajout√©e au projet en tant que ressource</li><li>Pas de photo</li><li>Une photo pointant sur une url retournant une erreur 404</li><li>Une photo pointant sur une url inaccessible</li>
  </ol>

  <p>
    Les trois derniers cas pr√©sentent une image de substitution par d√©faut car aucune photo valide ne peut √™tre affich√©e.
  </p>

  <p>
    Les contacts enregistr√©s comme favoris sont signal√©s par une bordure jaune autour de la photo.
  </p>

  <p>
    Pour finir, si vous observez bien l'animation vous remarquerez un bref indicateur de chargement sur les deux derni√®res photos, le temps que Xamarin.Forms √©choue √† charger les images.
  </p>

  <p>
    Mais je vous vois fr√©tiller d'impatience, vous √™tes venu ici pour voir du code, alors allons-y
  </p>

    <h2 id="clip-clip-clip-dcoupage-de-limage">
      Clip clip clip, d√©coupage de l'image
    </h2>

  <p>
    Plut√¥t que de vous livrer de gros blocs de code illisibles sur une page web, je vais dans cet article aller directement √† l'essentiel, vous trouverez le code complet sur mon <a href="https://github.com/SylvainMoingeon" target="_blank">compte GitHub</a>, comme d'habitude.
  </p>

  <p>
    Pour commencer, comment afficher une image circulaire ?
  </p>

  <p>
    Nous allons utiliser deux fonctionnalit√©s apparues derni√®rement dans Xamarin.Forms, la propri√©t√© <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/geometries#clip-with-a-geometry" target="_blank">Clip</a>&nbsp;(<i>d√©couper</i> en anglais) et les <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/geometries" target="_blank">Geometries</a>.
  </p>

  <p>
    <code>Clip</code> est une propri√©t√© des <a href="https://docs.microsoft.com/en-us/dotnet/api/xamarin.forms.visualelement" target="_blank">VisualElements</a>, de type <code>Geometry</code> et qui d√©finit le contour du contenu d'un √©l√©ment visuel.&nbsp;
  </p>

  <p>
    Ce n'est pas clair ? Un exemple, celui qui nous concerne : j'ai une image carr√©e et je souhaite afficher uniquement son contenu inscrit dans un cercle. Je vais donc d√©finir une <code>Geometry</code> circulaire et l'appliquer √† <code>Clip</code> pour d√©couper l'image selon cette forme.
  </p>

  <p>
    Attention les yeux, voici le code :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Image Source="monimage.png" HeightRequest="200" WidthRequest="200"&gt;
    &lt;Image.Clip&gt;
        &lt;EllipseGeometry RadiusX="100"
                         RadiusY="100"
                         Center="100,100" /&gt;
    &lt;/Image.Clip&gt;
&lt;/Image&gt;</code></pre>

  <p>
    La g√©om√©trie circulaire n'existant pas, nous nous baserons sur une ellipse. Celle-ci se d√©finit √† partir d'un centre et de deux rayons, horizontal (<code>RadiusX</code>) et vertical (<code>RadiusY</code>). Pour obtenir un cercle, il suffit que <code>RadiusX</code> et <code>RadiusY</code> aient la m√™me valeur. <code>Center</code> permet de positionner l'ellipse par rapport √† son contenant.
  </p>

  <p>
    Pour simplifier le calcul et le positionnement, autant partir d'une image carr√©e.
  </p>

  <p>
    Pour obtenir un cercle centr√© et inscrit dans le carr√©, les rayons seront moiti√© plus petits que le c√¥t√© de l'image et le centre du cercle sera au centre de l'image.
  </p>

  <p>
    Voil√†, obtenir une image circulaire c'est devenu aussi simple que √ßa avec Xamarin.Forms. Beaucoup de texte et d'explications pour quelque chose devenu finalement assez trivial !
  </p>

    <h2 id="limage-de-substitution">
      L'image de substitution
    </h2>

  <p>
    Comment faire pour afficher une image par d√©faut quand il n'y a pas d'image √† afficher ?
  </p>

  <p>
    On va utiliser une technique ancienne et bien connue mais toujours tr√®s utile : l'empilement dans une <code>Grid</code>. Les √©l√©ments contenus dans une m√™me cellule d'une Grid se superposent les uns sur les autres, le dernier d√©clar√© dans le fichier Xaml √©tant au-dessus, la lecture de celui-ci √©tant s√©quentielle.
  </p>

  <p>
    Nous allons donc d√©finir une Grid √† une seule cellule et y ajouter deux <code>Images</code> : la premi√®re est destin√©e √† afficher l'image de substitution, la seconde √† afficher l'image proprement dite.
  </p>

  <p>
    Pour que les deux images se superposent sans d√©calage, il est n√©cessaire que les deux composants <code>Image</code>&nbsp;et leurs ellipses aient les m√™mes dimensions.
  </p>

  <p>
    Nous renseignerons √©galement les propri√©t√©s <code>HorizontalOptions</code> et <code>VerticalOptions</code> de la Grid avec des valeurs qui forceront celle-ci √† adopter les m√™mes dimensions que son contenu.
  </p>

  <p class="msg msg--info">
    <a href="https://fr.wikipedia.org/wiki/Ne_vous_r√©p√©tez_pas" target="_blank">DRY</a> - Je vais avoir besoin de cr√©er deux fois une image circulaire simple, et il est probable que ce besoin se r√©p√®te dans d'autres contextes. Dans la <a href="https://www.sylvainmoingeon.fr/creer-un-controle-reutilisable-100-xamarinforms-partie-2/">seconde partie de l'article</a>, nous verrons comment cr√©er un contr√¥le&nbsp;<code>CircleImage</code>&nbsp;r√©utilisable encapsulant le code pr√©c√©dent.&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid HorizontalOptions="Center" VerticalOptions="Center"&gt;
    &lt;local:CircleImage Source="monPlaceholder.png" ImageSize="128" /&gt;
    &lt;local:CircleImage Source="monImage.png" ImageSize="128" /&gt;
&lt;/Grid&gt;</code></pre>

  <p>
    De cette mani√®re, l'image vient cacher le placeholder si elle est disponible, sinon on voit ce dernier √† la place.
  </p>

    <h2 id="lindicateur-de-chargement">
      L'indicateur de chargement
    </h2>

  <p>
    Aujourd'hui c'est atelier empilage, nous allons encore superposer : ajoutons un <code>ActivityIndicator</code> √† notre Grid.
  </p>

  <p>
    L'<code>ActivityIndicator</code> a un visuel l√©g√®rement diff√©rent sous Android et iOS mais le principe reste le m√™me : c'est un bidule qui tourne de fa√ßon hypnotique pour faire oublier le temps qui passe √† l'utilisateur. Pour le voir tourner, il suffit d'affecter <code>True</code> √† sa propri√©t√© <code>IsRunning</code>.
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid&gt;
    &lt;local:CircleImage x:Name="monPlaceholder" ImageSize="128" /&gt;
    &lt;local:CircleImage x:Name="monImage" ImageSize="128" /&gt;
    
    &lt;ActivityIndicator  IsRunning="True"
                        VerticalOptions="Center"
                        HorizontalOptions="Center"
                        /&gt;
&lt;/Grid&gt;</code></pre>

  <p>
    Nous avons donc un indicateur qui tourne au centre de notre image. C'est bien, mais il tourne en permanence et nous aurions besoin de l'activer uniquement pendant le chargement de l'image.
  </p>

  <p>
    Cela tombe bien, le contr√¥le <code>Image</code> expose une propri√©t√© <code>IsLoading</code>&nbsp;qui vaut <code>True</code> pendant le chargement de l'image et <code>False</code> une fois le chargement termin√©, peu importe que l'op√©ration ce soit bien d√©roul√©e ou non.
  </p>

  <p>
    Reste une question : comment lier la propri√©t√© <code>IsRunning</code> de l'indicateur √† la propri√©t√© <code>IsLoading</code> de l'image ? Par un <code>Binding</code>&nbsp;bien entendu ! Mais comment binder une propri√©t√© d'un contr√¥le&nbsp;√† une propri√©t√© d'un autre contr√¥le ? En pr√©cisant la source du Binding !
  </p>

  <p>
    Le plus simple ici est de donner un nom explicite √† notre contr√¥le Image (<i>monImage</i> par exemple) et de se r√©f√©rer √† ce nom comme source du Binding. La propri√©t√© vis√©e sera d√©finie comme <code>Path</code> du Binding :&nbsp;<code>"{Binding Source={x:Reference monImage}, Path=IsLoading}"</code>
  </p>

  <p>
    Avec un peu plus de contexte, cela donne :
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid&gt;
    &lt;local:CircleImage x:Name="monPlaceholder" ImageSize="128" /&gt;
    &lt;local:CircleImage x:Name="monImage" ImageSize="128" /&gt;
    
    &lt;ActivityIndicator  IsRunning="{Binding Source={x:Reference monImage}, Path=IsLoading}"
                        VerticalOptions="Center"
                        HorizontalOptions="Center"
                        /&gt;
&lt;/Grid&gt;
</code></pre>

  <p>
    De cette fa√ßon, nous verrons un indicateur de chargement tournoyer au centre de l'image durant le chargement de celle-ci.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/36/activityIndicator-3.gif" height="74" width="74" alt="ActivityIndicator au centre d'une image" >
      <figcaption>Et pourtant, elle tourne !</figcaption>
    </figure>

    <h2 id="la-bordure">
      La bordure
    </h2>

  <p>
    Pour afficher une bordure autour de l'image, nous allons tirer parti des <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/" target="_blank"><code>Shapes</code></a> encore sous forme exp√©rimentale sous Xamarin.Forms 4.8.
  </p>

  <p>
    Si la version de Xamarin.Forms que vous utilisez n'int√®gre pas encore les <code>Shapes</code> de fa√ßon officielle, vous devrez d√©clarer la fonctionnalit√© exp√©rimentale dans le constructeur de la classe&nbsp;<code>App.xaml.cs</code>&nbsp;sous peine de lever une <code>InvalidOperationException</code> au lancement de l'application :
  </p>
<pre class="line-numbers  language-csharp"><code>public App()
{
    Device.SetFlags(new string[] { "Shapes_Experimental" });
    
    InitializeComponent();
    
    MainPage = new MainPage();
}
</code></pre>

  <p>
    Les <code>Shapes</code> comme leur nom l'indique sont des formes que l'on peut ajouter en tant que <code>VisualElement</code> sur la page. La forme qui nous int√©resse est l√† encore une <code><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/shapes/ellipse" target="_blank">Ellipse</a></code>.
  </p>

  <p class="msg msg--highlight">
    Attention √† ne pas confondre l'<code>EllipseGeometry</code> qui est la <b>description</b> d'un objet g√©om√©trique, avec l'<code>Ellipse</code> qui est un contr√¥le Visuel !
  </p>

  <p>
    <code>Stroke</code> et <code>StrokeThickness</code> sont les deux propri√©t√©s expos√©es par l'Ellipse qui d√©finissent la couleur et l'√©paisseur de son contour. Nous n'aurons pas besoin des autres propri√©t√©s, mais nous pourrions affiner en d√©finissant le type de contour (pointill√©...) ou la couleur de remplissage de l'ellipse.
  </p>
<pre class="line-numbers  language-html"><code>&lt;Ellipse Stroke="Yellow" StrokeThickness="2" /&gt;</code></pre>

  <p>
    Ensuite, c'est juste une histoire d'empilage dans la <code>Grid</code>, vous commencez √† avoir l'habitude.<br><br>
  </p>
<pre class="line-numbers  language-html"><code>&lt;Grid&gt;
    &lt;local:CircleImage x:Name="monPlaceholder" ImageSize="128" /&gt;
    &lt;local:CircleImage x:Name="monImage" ImageSize="128" /&gt;
    
    &lt;Ellipse Margin="0"
             HorizontalOptions="Center"
             VerticalOptions="Center"
             Stroke="Yellow"
             StrokeThickness="2"
             HeightRequest="128"
             WidthRequest="128"
             /&gt;
             
    &lt;ActivityIndicator [...]  /&gt;
&lt;/Grid&gt;</code></pre>

  <p>
    Ce qui donne :
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/36/circle-with-border.png" height="223" width="223" alt="Une image circulaire bord√©e de jaune"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/36/responsive/circle-with-border-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/36/responsive/circle-with-border-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/36/responsive/circle-with-border-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/36/responsive/circle-with-border-lg.png 1024w">
      <figcaption>Une image circulaire bord√©e de jaune</figcaption>
    </figure>

    <h2 id="fin-de-premire-partie">
      Fin de (premi√®re) partie
    </h2>

  <p>
    L'article s'av√®re bien plus d√©taill√© que je ne l'avais pr√©vu au d√©part et √ßa commence √† √™tre bien consistant. Je vous laisse donc dig√©rer tout √ßa et vous donne rendez-vous pour la seconde partie dans laquelle nous verrons comment assembler tout ceci pour en faire un contr√¥le r√©utilisable avec des propri√©t√©s Bindable pour le rendre "<a href="https://www.sylvainmoingeon.fr/tags/mvvm/">MVVM</a> friendly".
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>L&#x27;inversion de d√©pendance facile (et pas ch√®re)</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/xamarinforms-inversion-de-dependance-facile-et-pas-chere/"/>
        <id>https://www.sylvainmoingeon.fr/xamarinforms-inversion-de-dependance-facile-et-pas-chere/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/34/ioc-cover.jpg" medium="image" />
            <category term="ioc"/>
            <category term="bonnes pratiques"/>
            <category term="Xamarin.Forms"/>
            <category term="SOLID"/>

        <updated>2020-09-29T18:42:53+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/34/ioc-cover.jpg" alt="" />
                    
  <p>
    Ah, l'inversion de d√©pendance, voil√† une pratique qui est parfois difficile √† faire passer dans les √©quipes. En particulier quand il s'agit d'applications mobiles. Les arguments sont toujours les m√™mes :&nbsp;
  </p>

  <ul>
    <li>√áa ajoute trop de complexit√©</li><li>√áa bouffe des ressources et plombe les performances</li><li>On n'en a pas besoin de toute fa√ßon on n'utilise qu'une seule impl√©mentation</li><li>Les frameworks c'est le mal absolu</li>
  </ul>

    <blockquote class="blockquote">
      - Tu peux m'expliquer l'inversion de d√©pendance ?<br>- Fastoche, tu ouvres le gestionnaire de package nuget et tu installes AutoFac<br>
    </blockquote>

  <p>
    Et si on trouvait un moyen simple, efficace et sans framework d'inverser les d√©pendances ?
  </p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/34/ioc-cover.jpg" class="type:primaryImage" alt="" /></p>
                
  <p>
    Ah, l'inversion de d√©pendance, voil√† une pratique qui est parfois difficile √† faire passer dans les √©quipes. En particulier quand il s'agit d'applications mobiles. Les arguments sont toujours les m√™mes :&nbsp;
  </p>

  <ul>
    <li>√áa ajoute trop de complexit√©</li><li>√áa bouffe des ressources et plombe les performances</li><li>On n'en a pas besoin de toute fa√ßon on n'utilise qu'une seule impl√©mentation</li><li>Les frameworks c'est le mal absolu</li>
  </ul>

    <blockquote class="blockquote">
      - Tu peux m'expliquer l'inversion de d√©pendance ?<br>- Fastoche, tu ouvres le gestionnaire de package nuget et tu installes AutoFac<br>
    </blockquote>

  <p>
    Et si on trouvait un moyen simple, efficace et sans framework d'inverser les d√©pendances ?
  </p>


    <h2 id="inversion-et-injection-de-dpendances">
      Inversion et injection de d√©pendances
    </h2>

  <p>
    Le but ici n'est pas de proposer un cours complet sur les principes d'inversion et d'injection de d√©pendances mais juste de pr√©senter une astuce rapide, facile et pas ch√®re pour effectuer une inversion de d√©pendance sans avoir recours √† aucun framework.
  </p>

  <p>
    Si vous ne connaissez pas ces principes, je vous invite √† vous rendre sur votre moteur de recherche pr√©f√©r√© et d'y saisir les mots cl√©s suivants (pas tous en m√™me temps, hein !) : <a href="https://lmgtfy.app/?q=inversion+de+d%C3%A9pendance" target="_blank">inversion de d√©pendance</a> / <a href="https://lmgtfy.app/?q=injection+d%C3%A9pendance" target="_blank">injection de d√©pendance</a> / <a href="https://lmgtfy.app/?q=dependency+inversion+principle" target="_blank">dependency inversion</a> / <a href="https://lmgtfy.app/?q=dependency+injection+principle" target="_blank">dependency injection</a> / <a href="https://lmgtfy.app/?q=constructor+injection" target="_blank">constructor injection</a> / <a href="https://lmgtfy.app/?q=ioc+di" target="_blank">ioc di</a>.
  </p>

  <p>
    Vous verrez qu'assez souvent cela vous ram√®ne √† l'un ou l'autre des frameworks √† la mode. Et dans les cas les plus complexes, c'est pertinent de ne pas r√©inventer la roue. Mais dans une application mobile, on a souvent besoin de quelque chose de beaucoup plus simple sans s'encombrer d'un framework ou d'une biblioth√®que suppl√©mentaire.
  </p>

    <h2 id="pourquoi-une-inversion-de-contrle-">
      Pourquoi une inversion de contr√¥le ?
    </h2>

  <p>
    Sans m'√©tendre sur le sujet, le but principal de l'inversion de contr√¥le est de ne pas laisser une classe d√©pendre d'autres classes. Elle ne doit d√©pendre que <a href="https://fr.wikipedia.org/wiki/Abstraction_(informatique)#Programmation_orient√©e_objet" target="_blank">de leurs abstractions</a>.
  </p>

  <p>
    L'application de ce principe a des cons√©quences assez vari√©es mais qui vont toutes dans le sens d'un code plus propre et mieux structur√© :
  </p>

  <ul>
    <li><b>Respect du principe de <a href="https://fr.wikipedia.org/wiki/Principe_de_responsabilit√©_unique" target="_blank">responsabilit√© unique</a></b> : la classe ne voit que des abstractions, la responsabilit√© de ce qu'il s'y passe concr√®tement ne la regarde pas</li><li><b>D√©couplage</b> : les classes ne sont pas li√©es entre elles</li><li><b>Modularit√©</b> : une classe n'√©tant pas li√©e √† une impl√©mentation particuli√®re de ses d√©pendances, celle-ci est facilement interchangeable. Une m√™me classe pourra, par exemple, lire les donn√©es dans une base Sql, un fichier json ou xml en fonction de l'impl√©mentation du service d'acc√®s aux donn√©es inject√©.</li><li><b>Testabilit√©</b> : puisqu'on ne d√©pend pas d'une impl√©mentation concr√®te, on peut facilement utiliser des <a href="https://fr.wikipedia.org/wiki/Mock_(programmation_orient√©e_objet)" target="_blank">simulacres</a> pour effectuer des tests unitaires.</li>
  </ul>

  <p>
    Pour l'astuce que je vais vous pr√©senter tr√®s bient√¥t (je vous tiens en haleine !) nous allons passer les d√©pendances via le constructeur de la classe.
  </p>

  <p>
    L'int√©r√™t est double :
  </p>

  <ul>
    <li><b>Le code est lisible</b> car la liste des d√©pendances d'une classe est directement dans la signature de son constructeur : pas de surprise cach√©e dans le code de la classe</li><li>On ne peut pas oublier de passer une d√©pendance √† la classe puisqu'on en a besoin pour l'instancier</li>
  </ul>

  <p>
    Ici, les puristes auront sans doute les poils qui se dressent car ce que je vais vous montrer n'est pas au sens strict de l'injection de d√©pendance, mais pour les cas simples, √ßa en pr√©sente tous les avantages.
  </p>

  <p>
    Ce que nous allons chercher √† faire c'est avoir pour une classe :
  </p>

  <ul>
    <li>Une impl√©mentation par d√©faut de ses d√©pendances</li><li>La possibilit√© d'injecter d'autres impl√©mentations en cas de besoin (notamment pour les tests unitaires)</li>
  </ul>

    <h2 id="linversion-de-contrle-pas--pas">
      L'inversion de contr√¥le pas √† pas
    </h2>

    <h3 id="partons-de-pas-grandchose">
      Partons de pas grand-chose
    </h3>

  <p>
    Partons d'une classe ne suivant aucun pattern particulier, la d√©pendance est directement instanci√©e dans le corps de la classe. Beurk !
  </p>
<pre class="line-numbers  language-csharp"><code>public class MaClasse
{
    private readonly MaDepdendance _maDependance;

    MaClasse()
    {
        _maDependance = new MaDependance();
    }
}</code></pre>

  <p>
    Imaginez juste un instant que la classe <code>MaDependance</code> d√©pende elle-m√™me d'une autre classe, bienvenue au <a href="https://www.sylvainmoingeon.fr/developpez-des-applications-sans-crotte-de-nez/">code spaghetti et aux crottes de nez dans le code</a> !
  </p>

  <p>
    Dans un premier temps, nous allons simplement chercher √† passer la d√©pendance depuis l'ext√©rieur. De cette fa√ßon, notre classe n'aura plus la responsabilit√© de l'instancier. Rien de bien compliqu√©.
  </p>
<pre class="line-numbers  language-csharp"><code>public class MaClasse
{
    private readonly MaDepdendance _maDependance;

    // d√©pendance inject√©e via la constructeur
    MaClasse(MaDependance maDependance)
    {
        _maDependance = maDependance ?? throw new ArgumentNullException("Un message bien senti !");
    }
}</code></pre>

  <p>
    Mieux mais pas terrible. Nous n'avons en r√©alit√© fait que d√©placer le probl√®me. Pour l'instant, toujours pas de d√©couplage ou de modularit√© dans le code.
  </p>

    <h3 id="dpendons-de-labstraction-au-lieu-de-limplmentation">
      D√©pendons de l'abstraction au lieu de l'impl√©mentation
    </h3>

  <p>
    Pour faire mieux, nous allons appliquer <i>stricto-sensu</i> le principe d'inversion de contr√¥le : <b>d√©pendre d'abstraction au lieu d'impl√©mentation</b>.
  </p>
<pre class="line-numbers  language-csharp"><code>public class MaClasse
{
    private readonly IMaDependance _maDependance;

    // On injecte une abstraction (interface) au lieu d'une impl√©mentation concr√®te
    MaClasse(IMaDependance maDependance)
    {
        _maDependance = maDependance ?? throw new ArgumentNullException("Un message bien senti !");
    }
}</code></pre>

  <p>
    Vous avez vu ? Le "I" pour <code>interface</code>&nbsp;?&nbsp;
  </p>

  <p>
    Ce n'est bien entendu qu'une convention de nommage, mais en r√©alit√© il s'est pass√© ceci :
  </p>
<pre class="line-numbers  language-csharp"><code>// interface d√©crivant les membres √† impl√©menter
public interface IMaDependance
{
    MaMethode();
}

// MaDependance impl√©mente d√©sormais l'interface IMaDependance
public class MaDependance : IMaDependance
{
    public void MaMethode()
    {
        // impl√©mentation de l'interface
    }
}</code></pre>

  <p>
    Au lieu de passer directement l'impl√©mentation concr√®te de la d√©pendance, nous avons pass√© son abstraction. Chouette !
  </p>

  <p>
    Reste un souci. Sans l'aide d'un framework qui ferait √ßa dynamiquement, il reste n√©cessaire de passer explicitement les d√©pendances au constructeur de notre classe lors de son instanciation.
  </p>

  <p>
    Double probl√®me :
  </p>

  <ol>
    <li>Cela peut vite devenir tr√®s lourd si la classe a plusieurs d√©pendances</li><li>Que se passe t'il si l'on souhaite changer d'impl√©mentation alors que celle-ci est pass√©e en dur partout dans le code ?</li>
  </ol>

    <h3 id="ajoutons-une-implmentation-par-dfaut">
      Ajoutons une impl√©mentation par d√©faut
    </h3>

  <p>
    Pour ajouter une impl√©mentation pour d√©faut, nous allons simplement tirer parti du mot cl√© <code>this</code> appliqu√© au constructeur de la classe. <code>this</code> permet, en effet, d'appeler un constructeur √† partir d'un autre constructeur.&nbsp;
  </p>
<pre class="line-numbers  language-csharp"><code>public class MaClasse
{
    private readonly IMaDependance _maDependance;

    // Constructeur acceptant un argument
    MaClasse(IMaDependance maDependance)
    {
        _maDependance = maDependance ?? throw new ArgumentNullException("Un message bien senti !");
    }

    // Constructeur vide, qui par appelle l'autre constucteur avec 'this'
    MaClasse() : this(new MaDepdendance()){}
}</code></pre>

  <p>
    De cette mani√®re, le constructeur vide appellera syst√©matiquement le constructeur ayant la d√©pendance en argument en lui passant une impl√©mentation concr√®te.
  </p>

  <p>
    Nous obtenons donc deux mani√®res d'instancier notre classe :&nbsp;
  </p>

  <ul>
    <li>Avec le constructeur vide : la d√©pendance sera impl√©ment√©e par d√©faut</li><li>Avec l'autre constructeur : la d√©pendance sera impl√©ment√©e <i>manuellement</i> par le d√©veloppeur</li>
  </ul>

  <p>
    Nous avons donc atteint notre objectif premier avec un simple mot cl√© <code>this</code> du langage C#&nbsp;
  </p>

  <p>
    C'est bien, mais il subsiste un probl√®me : l'impl√©mentation par d√©faut est instanci√©e en dur dans le code :
  </p>

  <ul>
    <li>Si on suit les principes <a href="https://fr.wikipedia.org/wiki/SOLID_%28informatique%29" target="_blank">SOLID</a>, <b>une classe doit √™tre √©volutive sans modification</b>. Ici, ce n'est pas le cas : le jour o√π on aura besoin de changer d'impl√©mentation par d√©faut, il sera n√©cessaire de modifier le code au niveau du constructeur.</li><li>Si plusieurs classes d√©pendent du m√™me service, on risque simplement d'oublier de modifier le constructeur de l'une ou l'autre des classes qui utilisent <code>MaDependance</code>.</li>
  </ul>

  <p>
    Trouvons donc un moyen de globaliser la correspondance entre une abstraction et son impl√©mentation par d√©faut. C'est-√†-dire, qu'en pratique, <b>pour une interface donn√©e on obtienne syst√©matiquement la m√™me impl√©mentation</b>.
  </p>

    <h3 id="prenons-une-bonne-rsolution">
      Prenons une bonne r√©solution
    </h3>

  <p>
    Avec Xamarin.Forms nul besoin de chercher tr√®s loin, le <code>DependencyService</code> jouera ce r√¥le √† merveille.&nbsp;
  </p>

  <p class="msg msg--highlight">
    A strictement parler, le <code>DependencyService</code> sert surtout √† la r√©solution d'impl√©mentations natives (dans les projets iOS, Android...) pour les utiliser dans le projet commun Xamarin.Forms.<br>En pratique, cela fonctionne tr√®s bien pour r√©soudre n'importe quel type.<br>
  </p>

  <p>
    Le <code>DependencyService</code> expose principalement trois m√©thodes : <code>Register</code>, <code>Get</code> et <code>Resolve</code>.&nbsp;
  </p>

  <p>
    <code>Register</code> ne souffre pas d‚Äôambigu√Øt√©, c'est ici que nous enregistrerons notre impl√©mentation par d√©faut.
  </p>

  <p>
    Pour la simplicit√© de la d√©monstration, et parce qu'en pratique ce sera souvent le cas, je prends la classe <code>App.xaml.cs</code> comme point d'entr√©e pour enregistrer mes d√©pendances.
  </p>
<pre class="line-numbers  language-csharp"><code>public partial class App : Application
{
    public App()
    {
        InitializeComponent();
        
        // On enregistre le type MaDependance pour l'interface IMaDependance
        DependencyService.Register&lt;IMaDependance, MaDependance&gt;();
        
        MainPage = new MainPage();
    }
    
    //[...]
 }</code></pre>

  <p>
    Faites comme vous voulez, ce qui est important c'est de bien enregistrer les types avant toute utilisation du <code>DependencyService</code> dans le code, cela va de soi.
  </p>

  <p>
    <code>Get</code> et <code>Resolve</code> semblent fonctionner de mani√®re identique, cependant la documentation affich√©e dans Visual Studio nuance quelque peu leur usage :
  </p>

  <p>
    <strong></strong><em><strong>Resolve</strong> :&nbsp;The method to use to resolve dependencies by type<br><strong>Get</strong> :&nbsp;Returns the platform-specific implementation of type T</em>
  </p>

  <p>
    <code>Resolve</code> semble mieux correspondre √† notre besoin.
  </p>
<pre class="line-numbers  language-csharp"><code>public class MaClasse
{
    private readonly IMaDependance _maDependance;

    MaClasse(IMaDependance maDependance)
    {
        _maDependance = maDependance ?? throw new ArgumentNullException("Un message bien senti !");
    }
    
    // On r√©soud le type avec le DependencyService
    MaClasse() : this(DependencyService.Resolve&lt;IMaDependance&gt;()){}
}</code></pre>

  <p>
    D√©sormais, notre classe ne d√©pend plus d'aucune impl√©mentation concr√®te, elle n'est plus qu'abstraction !&nbsp;
  </p>

  <p>
    Imaginons que de nombreuses classes d√©pendent de <code>IMaDependance</code> et qu'on ait besoin de changer l'impl√©mentation de la d√©pendance partout dans le code, il suffira de remplacer l'impl√©mentation enregistr√©e dans&nbsp;<code>DependencyService.Register</code>.
  </p>

  <p>
    Pour le reste, √ßa n'a pas chang√© : pour injecter une impl√©mentation diff√©rente il est n√©cessaire d'instancier la classe en passant explicitement la d√©pendance dans le constructeur. Ce sera notamment le cas pour les simulacres cr√©√©s √† fin de tests unitaires.
  </p>

    <h2 id="conclusion">
      Conclusion
    </h2>

  <p>
    Si l'inversion de contr√¥le est souvent confondue avec le framework qui la met en oeuvre, il s'agit en r√©alit√© d'un principe √† l'√©nonc√© plut√¥t simple : <i>une classe doit d√©pendre d'abstractions et non d'impl√©mentations</i>.
  </p>

  <p>
    Et dans les cas simples, on peut l'appliquer <b>sans framework</b> et profiter de ses avantages √† moindre frais : <b>d√©couplage</b>, <b>modularit√©</b>, <b>testabilit√©</b>.
  </p>

  <p>
    Je vous en ai pr√©sent√© ici une fa√ßon fort simple √† base d'<code>interface</code>, d'appel √† un constructeur par d√©faut avec le mot cl√© <code>this</code> et du <code>DependencyService</code> de Xamarin.Forms.
  </p>

  <p class="msg msg--info">
    Pour un projet mobile, c'est souvent largement suffisant !
  </p>

    <h2 id="le-code-source">
      Le code source
    </h2>

  <p>
    Comme toujours, un petit projet d'exemple sur mon <a href="https://github.com/SylvainMoingeon/DITheEasyWayDemo" target="_blank">GitHub</a>. Celui-ci est minimaliste : un service, un ViewModel et un test unitaire. Son seul int√©r√™t est de d√©montrer le fonctionnement de tout cela de fa√ßon un peu moins th√©orique.
  </p>

  <p>
    Et chez vous l'inversion de contr√¥le, √ßa se passe comment ?
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>[Xamarin.Forms] MVVM - A quoi √ßa sert ?</title>
        <author>
            <name>Sylvain</name>
        </author>
        <link href="https://www.sylvainmoingeon.fr/xamarinforms-a-quoi-ca-sert-mvvm/"/>
        <id>https://www.sylvainmoingeon.fr/xamarinforms-a-quoi-ca-sert-mvvm/</id>
        <media:content url="https://www.sylvainmoingeon.fr/media/posts/33/question-mark.jpg" medium="image" />
            <category term="bonnes pratiques"/>
            <category term="Xamarin.Forms"/>
            <category term="XAML"/>
            <category term="MVVM"/>

        <updated>2020-09-04T19:15:55+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://www.sylvainmoingeon.fr/media/posts/33/question-mark.jpg" alt="" />
                    
  <p>
    Je m'en souviens encore, mon premier projet WPF o√π avec l'habitude des WinForms j'ai commenc√© √† coder la logique m√©tier dans le code-behind de la fen√™tre. J'ai alors senti un regard lourd dans mon dos, un ricanement et, tel le Denis Brogniart du code, mon coll√®gue qui me l√¢che son irr√©vocable sentence :
  </p>

    <blockquote class="blockquote">
      Avec WPF, tu dois faire du MVVM. D'ailleurs, √† partir d'aujourd'hui, on va tous faire du MVVM.
    </blockquote>

  <p>
    Et donc, on s'y est tous mis. De fa√ßon purement dogmatique, sans rien y comprendre. Ni le pourquoi, ni le comment. Sans conna√Ætre ses v√©ritables raisons d'√™tre, sans en avoir √©tudi√© les avantages et contraintes. Sans m√™me avoir conscience qu'il s'agissait d'une architecture logicielle et donc de la fondation de notre applicatif.
  </p>

  <p>
    Alors donc, ce f√ªt un grand moment de n'importe quoi o√π chacun cherchait par tous les moyens √† contourner les <i>probl√®mes</i> pos√©s par MVVM. <strong>Et quand tu commences √† consid√©rer ton architecture comme un probl√®me, c'est qu'il y en a un s√©rieux dans l'√©quipe de d√©veloppement</strong>. Bien entendu, les ressources sur le sujet √©taient t√©nues √† l'√©poque et consistaient principalement √† la r√©solution des <i>probl√®mes</i>&nbsp;apport√©s par MVVM. Oui, on √©tait tous dans le m√™me bateau.
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/dans-le-meme-bateau.jpg" height="531" width="940" alt="Les candidats de Koh Lanta sautent du bateau"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-xs.jpg 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-sm.jpg 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-md.jpg 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-lg.jpg 1024w">
      <figcaption>Revenez, ce n'est pas si terrible MVVM !</figcaption>
    </figure>

  <p>
    Heureusement, une dizaine d'ann√©es plus tard tout cela a bien chang√© et... hein ? Quoi ? C'est toujours comme √ßa ? Des √©quipes qui <i>font du MVVM</i> sans r√©fl√©chir, sans le comprendre, juste parce qu'on leur a dit <i>c'est comme √ßa</i>.
  </p>

  <p>
    Il est peut-√™tre temps de prendre un peu de recul et de comprendre √† quoi √ßa sert.
  </p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://www.sylvainmoingeon.fr/media/posts/33/question-mark.jpg" class="type:primaryImage" alt="" /></p>
                
  <p>
    Je m'en souviens encore, mon premier projet WPF o√π avec l'habitude des WinForms j'ai commenc√© √† coder la logique m√©tier dans le code-behind de la fen√™tre. J'ai alors senti un regard lourd dans mon dos, un ricanement et, tel le Denis Brogniart du code, mon coll√®gue qui me l√¢che son irr√©vocable sentence :
  </p>

    <blockquote class="blockquote">
      Avec WPF, tu dois faire du MVVM. D'ailleurs, √† partir d'aujourd'hui, on va tous faire du MVVM.
    </blockquote>

  <p>
    Et donc, on s'y est tous mis. De fa√ßon purement dogmatique, sans rien y comprendre. Ni le pourquoi, ni le comment. Sans conna√Ætre ses v√©ritables raisons d'√™tre, sans en avoir √©tudi√© les avantages et contraintes. Sans m√™me avoir conscience qu'il s'agissait d'une architecture logicielle et donc de la fondation de notre applicatif.
  </p>

  <p>
    Alors donc, ce f√ªt un grand moment de n'importe quoi o√π chacun cherchait par tous les moyens √† contourner les <i>probl√®mes</i> pos√©s par MVVM. <strong>Et quand tu commences √† consid√©rer ton architecture comme un probl√®me, c'est qu'il y en a un s√©rieux dans l'√©quipe de d√©veloppement</strong>. Bien entendu, les ressources sur le sujet √©taient t√©nues √† l'√©poque et consistaient principalement √† la r√©solution des <i>probl√®mes</i>&nbsp;apport√©s par MVVM. Oui, on √©tait tous dans le m√™me bateau.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/dans-le-meme-bateau.jpg" height="531" width="940" alt="Les candidats de Koh Lanta sautent du bateau"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-xs.jpg 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-sm.jpg 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-md.jpg 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/dans-le-meme-bateau-lg.jpg 1024w">
      <figcaption>Revenez, ce n'est pas si terrible MVVM !</figcaption>
    </figure>

  <p>
    Heureusement, une dizaine d'ann√©es plus tard tout cela a bien chang√© et... hein ? Quoi ? C'est toujours comme √ßa ? Des √©quipes qui <i>font du MVVM</i> sans r√©fl√©chir, sans le comprendre, juste parce qu'on leur a dit <i>c'est comme √ßa</i>.
  </p>

  <p>
    Il est peut-√™tre temps de prendre un peu de recul et de comprendre √† quoi √ßa sert.
  </p>


    <h2 id="mvvm-mais-a-vient-do-">
      MVVM, mais √ßa vient d'o√π ?
    </h2>

  <p>
    Sans refaire un historique complet des technologies Microsoft, sachez qu'avec .NET 3.0 (sorti en 2007 il me semble) est apparu un nouveau paradigme de programmation, en particulier au niveau graphique. Exit les vieilles fen√™tres grises fig√©es sur lesquelles on n'avait aucune libert√© visuelle et dans lesquelles on m√©langeait all√®grement l'interface utilisateur et le code m√©tier. Bienvenue √† la conception graphique via la technologie <a href="https://docs.microsoft.com/en-us/visualstudio/xaml-tools/xaml-overview?view=vs-2019" target="_blank">XAML</a>. Le d√©veloppeur s'est alors retrouv√© devant deux langages distincts pour traiter l'affichage ou le code :
  </p>

  <ul>
    <li>XAML : un langage d√©claratif au gout de XML pour d√©crire l'interface graphique</li><li>Le code (C#, VB.Net...) : pour la logique, le code m√©tier...</li>
  </ul>

  <p>
    Voici un exemple de page Xamarin.Forms d√©crite en XAML :&nbsp;
  </p>
<pre class="line-numbers  language-html"><code>&lt;ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:XamlSamples"
             x:Class="XamlSamples.MainPage"&gt;

    &lt;StackLayout&gt;
        &lt;!-- Place new controls here --&gt;
        &lt;Label Text="Welcome to Xamarin Forms!"
               VerticalOptions="Center"
               HorizontalOptions="Center" /&gt;
    &lt;/StackLayout&gt;
&lt;/ContentPage&gt;</code></pre>

  <p>
    Bien entendu, il a fallu d'une fa√ßon ou d'une autre faire communiquer code et affichage. C'est pourquoi le concept de <a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/data-binding/" target="_blank">DataBinding</a> est devenu central avec XAML : les diff√©rentes propri√©t√©s des contr√¥les visuels (texte, couleur, visibilit√©, switch...) sont li√©es √† des propri√©t√©s dans le code et refl√®tent leurs valeurs et changement de valeurs de fa√ßon autonome et automatique.
  </p>

  <p>
    Par exemple, une liste sera affich√©e en √©tant "bind√©e" √† une collection dans le code. Une case √† cocher sera "bind√©e" √† une propri√©t√© bool√©enne...
  </p>

  <p>
    Ici, m√™me exemple que pr√©c√©demment mais le texte du <code>Label</code> est "bind√©" √† la propri√©t√© <code>RandomQuote</code> d'une classe. On peut imaginer, par exemple, que <code>RandomQuote</code> est une citation c√©l√®bre extraite al√©atoirement d'une liste.
  </p>
<pre class="line-numbers  language-html"><code>&lt;ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:XamlSamples"
             x:Class="XamlSamples.MainPage"&gt;

    &lt;StackLayout&gt;
        &lt;!-- Place new controls here --&gt;
        &lt;Label Text="{Binding RandomQuote}"
               VerticalOptions="Center"
               HorizontalOptions="Center" /&gt;
    &lt;/StackLayout&gt;
&lt;/ContentPage&gt;</code></pre>

  <p>
    Mais qui est charg√© d'exposer la propri√©t√© <code>RandomQuote</code> ? Comment les changements de valeurs de cette propri√©t√© seront propag√©s jusqu'au XAML ? Et inversement si la valeur est modifi√©e par l'utilisateur au niveau de l'interface, comment l'information est remont√©e dans la classe d'origine ?
  </p>

  <p>
    C'est pour r√©pondre √† ces questions et architecturer tout ceci que Microsoft a propos√© un nouveau mod√®le (repris depuis un peu partout) : <a href="https://fr.wikipedia.org/wiki/Mod%C3%A8le-vue-vue_mod%C3%A8le" target="_blank">MVVM, c'est-√†-dire Model-View-ViewModel</a>.
  </p>

  <p>
    <b>Ce qu‚Äôil faut en retenir c‚Äôest que cette architecture a pour but de d√©coupler les donn√©es (Model), la logique (ViewModel) et l‚Äôinterface utilisateur (View).&nbsp;</b>
  </p>

  <p>
    La View est d√©crite en XAML de fa√ßon purement d√©clarative. Elle dispose tout de m√™me d'un code-behind dans lequel on peut coder en C#, mais cela doit se limiter √† du code li√© √† l'affichage (d√©clencher une animation par exemple).
  </p>

  <p>
    Le Model est la repr√©sentation d'une donn√©e, au sens m√©tier du terme.&nbsp;
  </p>

  <p>
    Le ViewModel est la couche interm√©diaire qui pr√©pare les donn√©es et les expose √† la View. C'est g√©n√©ralement l√† qu'on trouvera la logique de validation des donn√©es, l'ex√©cution des calculs, l'appel aux diff√©rents services...
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/MVVMPattern.png" height="232" width="771" alt=""  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/MVVMPattern-xs.png 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/MVVMPattern-sm.png 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/MVVMPattern-md.png 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/MVVMPattern-lg.png 1024w">
      
    </figure>

  <p>
    Il y a donc un d√©coupage assez net et pr√©cis entre ce qui concerne l'affichage, ce qui va stocker les donn√©es et ce qui va pr√©parer les donn√©es.
  </p>

  <p>
    C'est l√† tout l'enjeu de MVVM, et pour que √ßa ne parte pas en cacahu√®tes, il y a bien entendu un certain nombre de r√®gles √† respecter.
  </p>

    <h2 id="du-bon-usage-de-mvvm">
      Du bon usage de MVVM
    </h2>

  <p>
    MVVM, c'est comme un <a href="https://fr.wikipedia.org/wiki/Gremlins" target="_blank">mogwai</a>, √ßa a l'air tout mignon <strong>tant qu'on suit scrupuleusement les r√®gles</strong>.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/guizmo.jpg" height="560" width="1000" alt="Guizmo"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/guizmo-xs.jpg 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/guizmo-sm.jpg 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/guizmo-md.jpg 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/guizmo-lg.jpg 1024w">
      <figcaption>MVVM... tant qu'on respecte les r√®gles !</figcaption>
    </figure>

    <h3 id="principes-de-base">
      Principes de base
    </h3>

  <ol>
    <li><strong>La View ne se pr√©occupe que de l'affichage et de l'interaction utilisateur.</strong>&nbsp;Elle ne contient ni ne manipule aucune donn√©e !</li><li><strong>Le ViewModel est agnostique de la View</strong>. Il ne sait ni quelle vue l'utilise ni comment elle compte le manipuler. Il sert √† pr√©parer les donn√©es √† partir de la couche Model mais ne contient pas, en principe, de logique m√©tier en lui-m√™me.</li><li><b>Le Model est agnostique du ViewModel et de la View</b>. Un Model est parfaitement ind√©pendant du reste du code, il est en mesure de vivre sa vie tout seul. Un Model est r√©utilisable directement dans un autre projet qui utiliserait la m√™me couche m√©tier, par exemple.</li><li>Ne jamais, mais alors ne jamais le nourrir apr√®s minuit !</li>
  </ol>

  <p>
    Ok, je vous parle depuis tout √† l'heure de View, de Model et de ViewModel, mais tout cela reste bien abstrait, voyons donc √ßa plus en d√©tails.
  </p>

    <h3 id="le-m-le-v-et-le-vm">
      Le M, le V et le VM
    </h3>

    <h4 id="v-comme-viewnbsp">
      V comme View&nbsp;
    </h4>

  <p>
    La View est un √©l√©ment visuel, une page par exemple, qui d√©finit la mise-en-page et l'apparence, mais √©galement l'interaction utilisateur (boite de dialogue...).
  </p>

  <p>
    La View r√©f√©rence un ViewModel via sa propri√©t√©&nbsp;<code>BindingContext</code>. Les contr√¥les sur la View h√©ritent du BindingContext de la View et sont li√©s √† des propri√©t√©s et des commandes expos√©e par le ViewModel via le syst√®me de <code>DataBinding</code>.<br><br>Un DataBinding peut √™tre personnalis√© de diverses mani√®res (validation, <a href="https://www.sylvainmoingeon.fr/tags/converters/">converters</a>, changement de BindingContext...) mais nous y reviendrons en d√©tail dans d'autres articles.
  </p>

  <p>
    Toute la logique d'affichage qui ne peut pas √™tre directement trait√©e en XAML est cod√©e dans le code-behind de la page.
  </p>

  <p class="msg msg--highlight">
    La View d√©finit le comportement visuel et r√©agit aux changements d'√©tats du ViewModel.
  </p>

    <h3 id="vm-comme-viewmodel">
      VM comme ViewModel
    </h3>

  <p>
    Le ViewModel est une classe non visuelle et qui ne r√©f√©rence en aucune fa√ßon ni la View ni aucun √©l√©ment relatif √† l'affichage. <strong>Il encapsule la <i>logique de pr√©sentation</i> mais pas son affichage</strong>. J'insiste car c'est une r√®gle trop souvent bafou√©e et qui m√®ne irr√©m√©diablement au monstre spaghetti.
  </p>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/spaghetti.jpg" height="465" width="620" alt="Un beau plat de spaghetti"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/spaghetti-xs.jpg 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/spaghetti-sm.jpg 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/spaghetti-md.jpg 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/spaghetti-lg.jpg 1024w">
      <figcaption>MVVM... quand on commence √† r√©f√©rencer la View dans le ViewModel</figcaption>
    </figure>

  <p>
    Le ViewModel expose des propri√©t√©s et des commandes auxquelles la View se lie par DataBinding : il notifie la View de ses changements d'√©tats √† travers l'interface&nbsp;<code>INotifyPropertyChanged</code>.&nbsp;
  </p>

  <p>
    En pratique, on cr√©e souvent une classe de base qui impl√©mente <code>INotifyPropertyChanged</code> et dont tous les ViewModels vont h√©riter. C'est plus simple comme √ßa.
  </p>

  <p>
    Les listes d'objets sont g√©n√©ralement expos√©es sous forme d'<code>ObservableCollections</code> qui impl√©mentent&nbsp;<code>INotifyCollectionChanged</code> pour informer la View de la suppression ou de l'ajout d'√©l√©ments dans la liste.
  </p>

  <p>
    Le cas √©ch√©ant, c'est le ViewModel qui contient la logique propre √† l'application (mais pas la logique m√©tier, en principe).
  </p>

  <p class="msg msg--highlight">
    Le ViewModel se charge de pr√©parer et de mettre en forme les donn√©es pour la View.
  </p>

    <h3 id="m-comme-model">
      M comme Model
    </h3>

  <p>
    Le Model encapsule les donn√©es, la logique m√©tier et la validation, m√™me si c'est sujet √† discussion. En pratique, la validation est parfois trait√©e directement par le ViewModel.
  </p>

  <p>
    Les Models ne r√©f√©rencent jamais ni la View, ni le ViewModel. Ce sont des entit√©s ind√©pendantes.
  </p>

  <p>
    Ils impl√©mentent la plupart du temps&nbsp;<code>INotifyPropertyChanged</code>.
  </p>

  <p>
    En fait, il y a deux √©coles :&nbsp;
  </p>

  <ul>
    <li>Le ViewModel expose directement les Models et donc ceux-ci impl√©mentent imp√©rativement&nbsp;<code>INotifyPropertyChanged</code></li><li>Le ViewModel encapsule les propri√©t√©s des Models et ce sont les propri√©t√©s du ViewModel qui sont bind√©e √† la View. Dans ce cas, c'est le ViewModel qui impl√©mente&nbsp;<code>INotifyPropertyChanged</code></li>
  </ul>

  <p>
    Qui a raison, qui a tort ? J'ai envie de dire, √ßa d√©pend du projet et du mod√®le de donn√©es. A titre personnel, je pr√©f√®re encapsuler les propri√©t√©s dans le ViewModel, c'est bien plus propre : la View ne voit que ce dont elle a besoin.
  </p>

    <h3 id="r-comme-rsum-">
      R comme R√©sum√© !
    </h3>

  <p class="msg msg--info">
    Pour r√©sumer, le ViewModel pr√©pare et expose des donn√©es pour que la View les affiche √† l‚Äô√©cran. Mais le ViewModel ne sait pas ce qu‚Äôen fait la View, c‚Äôest √† la View de se d√©brouiller avec ce que le ViewModel lui fournit.<br><br>Les Models sont ind√©pendants √† la fois de la View et du ViewModel. Ce sont eux qui contiennent la logique m√©tier, bien que ce sujet soit ouvert √† discussion (la doc Microsoft n'est pas toujours en accord avec elle-m√™me √† ce propos !).
  </p>

    <h3 id="avantages-de-mvvm">
      Avantages de MVVM
    </h3>

  <p>
    Le but de MVVM est de d√©coupler au maximum l'affichage de la logique et la logique des donn√©es. Mais pourquoi me direz-vous ?
  </p>

  <ul>
    <li>Pour rendre la logique (ViewModels) et les donn√©es (Models) unitairement testables sans avoir d'interaction avec l'interface.</li><li>Pour rendre l'interface graphique testable ind√©pendamment des donn√©es ! On peut, en effet, <em>mocker</em> les ViewModels et injecter des donn√©es de test directement dans la vue !</li><li>Pour √©viter que les donn√©es encapsulent la logique m√©tier / Pour √©viter que la pr√©sentation des donn√©es encapsule la logique m√©tier (rayez la mention inutile)</li><li>Pour √©largir le <a href="https://fr.wikipedia.org/wiki/Principe_de_responsabilit√©_unique" target="_blank">Principe de Responsabilit√© Unique</a> √† l'affichage et √† la pr√©sentation des donn√©es.</li><li>Pour √©viter qu'une modification au niveau de l'affichage ait des r√©percussions sur le code (ceux qui ont cod√© en VB6 savent de quoi je parle...)</li><li>Pour rendre le code modulable et r√©utilisable, en particulier la couche m√©tier.</li><li>Dans le monde des bisounours, on dit aussi que √ßa permet aux designers et aux d√©veloppeurs de travailler s√©par√©ment sans avoir √† attendre que l'un ou l'autre ait termin√© sa t√¢che. Dans le vrai monde, euh, vous avez un designer qui ne s'occupe que de dessiner les interfaces dans votre √©quipe ?</li><li>Pour rendre l'architecture du code lisible, on sait quoi va o√π</li><li>Pour rendre le code maintenable : il est d√©coup√© en briques √©l√©mentaires ind√©pendantes. En modifier une n'aura pas de r√©percussions inattendues √† l'autre bout du code</li><li>Pour √©viter de <a href="https://www.sylvainmoingeon.fr/developpez-des-applications-sans-crotte-de-nez/">coller des crottes de nez</a> dans le code.</li>
  </ul>

  <p class="msg msg--highlight">
    Pour r√©sumer, MVVM c'est une place pour chaque chose et chaque chose √† sa place.<br>L'id√©al est que chaque Model n'ait aucune d√©pendance vis-√†-vis des ViewModels et des Views et que chaque ViewModels n'ait aucune d√©pendance vis-√†-vis des Views.
  </p>

    <h3 id="les-contraintes-de-mvvm">
      Les contraintes de MVVM
    </h3>

  <p>
    Alors, MVVM, c'est tout beau tout rose ?
  </p>

  <p>
    Evidemment, racont√© comme √ßa, √ßa a l'air d'√™tre la panac√©e. En r√©alit√©, <b>MVVM est une architecture logicielle</b> et vient donc avec un certain nombre de r√®gles et de contraintes.
  </p>

  <p>
    C'est comme le code de la route. Il est l√† pour garantir la s√©curit√© de tous et √©viter les accidents, mais cela ne vient pas sans quelques restrictions √† nos libert√©s (s'arr√™ter au rouge, ne pas rouler √† contresens...).
  </p>

  <p>
    La principale question qui se pose quand on se lance pour la premi√®re fois dans un projet architectur√© autour de MVVM, c'est comment g√©rer les interactions utilisateurs dans le ViewModel.
  </p>

  <p>
    Je vous donne un exemple, sans doute le premier auquel vous serez confront√© : je clique sur un bouton <code>SUPPRIMER</code>, une boite de dialogue me demande de confirmer avant suppression. Simple n'est-ce pas ? Sauf que le code de suppression est dans le ViewModel, que la commande li√©e au bouton s'y ex√©cute directement et donc, comment fait-on pour afficher une boite de dialogue quand on est dans un ViewModel qui ne doit rien savoir de l'affichage ?
  </p>

  <p>
    Eh bien, ce n'est pas simple !
  </p>

  <p>
    Et l√†, deux √©coles s'affrontent :&nbsp;
  </p>

  <ul>
    <li>Ceux qui savent pourquoi ils utilisent MVVM et cherchent √† continuer √† en respecter les principes et bonnes pratiques. Cela demande plus de travail, cela demande de r√©ellement r√©fl√©chir √† l'architecture de l'application, mais √ßa assure une application bien structur√©e et maintenable dans le temps</li><li>Ceux qui ne se souviennent plus (ou n'ont jamais su) pourquoi ils utilisent MVVM et cherchent a r√©soudre le <i>probl√®me</i> par toutes les plus mauvaises solutions qui soient. Celles qu'ils consid√®rent comme plus simples et rapides et qui au final transforment le code en un Gremlins qui au fil du temps est de plus en plus incontr√¥lable.</li>
  </ul>

    <figure class="post__image post__image--center">
      <img decoding="async" loading="lazy" src="https://www.sylvainmoingeon.fr/media/posts/33/Gremlins.jpg" height="1337" width="2000" alt="Le chef des Gremlins revisite massacre √† la tron√ßonneuse"  sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://www.sylvainmoingeon.fr/media/posts/33/responsive/Gremlins-xs.jpg 300w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/Gremlins-sm.jpg 480w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/Gremlins-md.jpg 768w ,https://www.sylvainmoingeon.fr/media/posts/33/responsive/Gremlins-lg.jpg 1024w">
      <figcaption>MVVM... quand tu ne respectes pas les r√®gles !</figcaption>
    </figure>

  <p>
    Un exemple tr√®s simple, rencontr√© personnellement sur un projet :
  </p>

  <p>
    Une page de l'application freezait de fa√ßon <i>inexplicable</i>. Je n'ai pas mis longtemps √† lever le li√®vre : la View √©tait inject√©e dans le ViewModel !
  </p>

  <p>
    Cette violation directe de MVVM a conduit √† un effet extr√™mement pervers : un <a href="https://fr.wiktionary.org/wiki/deadlock" target="_blank">deadlock</a>. En fait, le ViewModel ex√©cutait une m√©thode d√©clar√©e dans le code-behind de la View qui elle-m√™me ex√©cutait une m√©thode du ViewModel qui attendait un r√©sultat de la View ! Et patatra ! Les pieds dans le tapis !
  </p>

  <p>
    Cela a √©t√© corrig√© en red√©coupant proprement le code. Certes, cela a demand√© plus de r√©flexion et mis plus de temps que le code d√©part qui √©tait <i>plus simple et plus rapide </i>√† mettre en place. Mais maintenant √ßa fonctionne et <b>surtout √ßa continue de fonctionner</b>&nbsp;malgr√© les √©volutions de l'application ! Au final, <b>prendre son temps fait gagner du temps</b>.
  </p>

  <p class="msg msg--highlight">
    En fait, le v√©ritable d√©fi avec MVVM est d'assurer la communication entre les diff√©rentes couches tout en prenant soin qu'elles ne se r√©f√©rencent pas les unes et les autres.
  </p>

    <h2 id="conclusion">
      Conclusion
    </h2>

  <p>
    Il y a encore beaucoup √† dire sur MVVM mais cet article est d√©j√† bien trop long et je souhaitais rester √† un certain niveau d'abstraction, n'aborder que les concepts de base.
  </p>

  <p>
    J'esp√®re que vous comprenez mieux les enjeux de MVVM, ses raisons d'√™tre.
  </p>

  <p>
    Si vous avez des questions ou si vous n'√™tes pas d'accord (vous avez le droit !) laissez-moi un commentaire !
  </p>

  <p class="msg msg--highlight">
    Je voudrais juste terminer en pr√©cisant que MVVM est un choix d'architecture, pas quelque chose qu'on vous impose et qu'il faut contourner !<strong><br><br>Si MVVM ne vous convient pas, il existe des alternatives. Plut√¥t que massacrer MVVM, trouvez l'architecture qui convient √† votre projet !</strong>
  </p>
            ]]>
        </content>
    </entry>
</feed>
